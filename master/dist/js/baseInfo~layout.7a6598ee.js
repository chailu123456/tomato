(window.webpackJsonp=window.webpackJsonp||[]).push([["baseInfo~layout"],{1990:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return g}));var r=n("5530"),a=n("1da1"),c=(n("96cf"),n("159b"),n("b64b"),n("ac1f"),n("5319"),n("7db0"),n("38d1")),o=n("afbc"),l=n("913c"),u=n("7a23"),i=n("67a4"),d=n("867b"),b=n("81ab"),s=n("0613"),p=n("2d40"),f=n("7b31"),m={name:[{required:!0,message:"请输入产品名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],notify_url:[{validator:function(e,t,n){t?/https:\/\/qyapi.weixin.qq.com\/cgi-bin\/webhook\/send\?key=(\w|\d|-){1,}/g.test(t)?n():n(new Error("格式错误，正确格式为 https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=")):n()},trigger:"blur"}]},j=Object(l.b)(!0),O=j.demandList,v=j.searchParams;function g(){var e=Object(u.getCurrentInstance)(),t=null==e?void 0:e.appContext.config.globalProperties,n=Object(u.ref)(null),m=Object(u.ref)(!1),j=Object(u.ref)(!1),g=Object(u.reactive)({name:"",remark:"",id:0,code:null,notify_url:"",is_approval:0,is_report:0,week_report:0,logo:"",team_id:0}),k=function(e){null==e||e.resetFields(),g.id=0},h=function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(b,h,V){var _;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&(n.value=b),!h){e.next=7;break}if(1!==(null==h?void 0:h.week_report)||null!=h&&h.team_id){e.next=4;break}return e.abrupt("return",f.a.warning("请选择团队"));case 4:Object.keys(g).forEach((function(e){g[e]=h[e]})),e.next=9;break;case 7:if(1!==(null==g?void 0:g.week_report)||null!=g&&g.team_id){e.next=9;break}return e.abrupt("return",f.a.warning("请选择团队"));case 9:null===(_=n.value)||void 0===_||_.validate(function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(n){var a,f,_,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=16;break}return a=h?c.db:c.h,e.next=4,a([g]);case 4:if(200!==e.sent.code){e.next=13;break}t.$message({message:"操作成功",type:"success"}),O.value=[],"function"==typeof V&&V(),m.value=!1,j.value=!0,e.next=14;break;case 13:return e.abrupt("return");case 14:f=Object(l.e)(),_=f.productLists,w=f.productId,Object(c.Z)().then((function(e){if(_.value=e.data,s.b.commit(p.a.updateProductList,e.data),h){var t=_.value.find((function(e){return e.id===w.value}));t&&s.b.commit(p.a.updateProductInfo,t)}else w.value=_.value[0]?_.value[0].id:[],s.b.commit(p.a.updateProductId,w.value),s.b.commit(p.a.updateProductInfo,_.value[0]),s.b.commit(p.a.updateCurrentIter,null),s.b.commit(p.a.updateIterateId,0),s.b.commit(p.a.updateIterateList,null),o.a.replace({query:Object.assign(Object(r.a)({},o.a.currentRoute.value.query),{productId:w.value})});var n=[];_.value.forEach((function(e){n.push({projectId:e.id,iterationId:null,yapi_default_iteration_id:e.yapi_default_iteration_id})})),Object(i.c)("cacheProject",JSON.stringify(n));var a=Object(d.a)();O.value=[],w.value&&a(w.value).then((function(e){O.value=e,v.demand=e.length?e[0].id:null})),Object(u.nextTick)((function(){k(b)}))}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return{getProductPermission:function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.c)(t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r.del_permission);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),resetDialogParams:k,handleShowDialog:function(){m.value=!0},dialogParams:g,confirmSave:h,dialogVisible:m,ConfirmGo:function(e){o.a.push({name:e}),j.value=!1},dialogVisibleBtn:j}}},"671c":function(e,t,n){"use strict";var r=n("5530"),a=(n("159b"),n("b64b"),n("b0c0"),n("7a23")),c=n("1990"),o=n("b23d"),l=n("7b31"),u=n("850a"),i=n("0a56"),d=function(e){return Object(a.pushScopeId)("data-v-6cb7046a"),e=e(),Object(a.popScopeId)(),e},b={class:"wrap"},s=d((function(){return Object(a.createElementVNode)("span",{class:"wrap-text"},"点击更换",-1)})),p=["src"],f=d((function(){return Object(a.createElementVNode)("span",{class:"product-form__special-text"},"企业微信群机器人地址，多个地址用“,”隔开；填写后番茄会在每天21:00将项目下各迭代情况发送到企业微信机器人所在群聊，便于项目汇报；",-1)})),m={key:0,style:{"margin-left":"10px"}},j={key:1,style:{"margin-left":"10px"}},O={key:0,style:{"margin-left":"10px"}},v={key:1,style:{"margin-left":"10px"}},g={key:0,style:{"margin-left":"10px"},class:"product-form-column"},k=Object(a.createTextVNode)(" 需要在部门周会中汇报 "),h={key:1,style:{"margin-left":"10px"}},V={class:"dialog-footer"},_=Object(a.createTextVNode)("保 存"),w=Object(a.createTextVNode)("取 消"),x=Object(a.defineComponent)(Object(r.a)(Object(r.a)({},{name:"handleProduct"}),{},{props:{visible:{type:Boolean,default:!1},dialogParams:{type:Object,default:function(){return{}}}},emits:["update:visible","updateInfo"],setup:function(e,t){var n=t.emit,r=e,d=Object(c.a)(),x=d.dialogParams,y=d.resetDialogParams,C=d.confirmSave,N=Object(a.ref)(null),B=Object(i.a)().boardBaseRt,P=Object(a.ref)(!1),E=Object(i.a)().onGetTeamList;Object(a.watch)((function(){return r.visible}),(function(){Object.keys(x).forEach((function(e){x[e]=r.dialogParams[e]})),x.week_report||(x.team_id=void 0),r.visible&&!B.teamList.length&&E()}),{deep:!0,immediate:!0});var I=function(){C(N.value,Object.keys(r.dialogParams).length?x:null,(function(){R(),n("updateInfo")}))},R=function(){y(N.value),n("update:visible",!1)},q=function(e){return"image/jpeg"!==e.type&&"image/png"!==e.type?(l.a.error("jpeg/png类型"),!1):(P.value=!0,!0)},L=function(e,t,n){x.logo=e.url,Object(a.nextTick)((function(){P.value=!1}))};return function(t,n){var r=Object(a.resolveComponent)("el-upload"),l=Object(a.resolveComponent)("el-form-item"),i=Object(a.resolveComponent)("el-input"),d=Object(a.resolveComponent)("el-switch"),y=Object(a.resolveComponent)("el-option"),C=Object(a.resolveComponent)("el-select"),E=Object(a.resolveComponent)("el-form"),U=Object(a.resolveComponent)("el-button"),D=Object(a.resolveComponent)("el-dialog"),S=Object(a.resolveDirective)("loading"),T=Object(a.resolveDirective)("debounce");return Object(a.openBlock)(),Object(a.createBlock)(D,{title:e.dialogParams.id?"编辑项目":"新增项目","close-on-press-escape":!1,modelValue:e.visible,"onUpdate:modelValue":n[8]||(n[8]=function(e){return Object(a.isRef)(visible)?visible.value=e:null}),width:"40%",center:"","append-to-body":!0,"custom-class":"handle-product-dialog",onClose:R},{footer:Object(a.withCtx)((function(){return[Object(a.createElementVNode)("span",V,[Object(a.withDirectives)((Object(a.openBlock)(),Object(a.createBlock)(U,{type:"primary",onClick:I},{default:Object(a.withCtx)((function(){return[_]})),_:1})),[[T]]),Object(a.createVNode)(U,{onClick:R},{default:Object(a.withCtx)((function(){return[w]})),_:1})])]})),default:Object(a.withCtx)((function(){return[Object(a.createVNode)(E,{model:Object(a.unref)(x),rules:Object(a.unref)(c.b),id:"productRef",ref_key:"productRef",ref:N,"label-width":"100px",class:"product-form"},{default:Object(a.withCtx)((function(){return[Object(a.createVNode)(l,{label:"项目logo",name:"logo"},{default:Object(a.withCtx)((function(){return[Object(a.withDirectives)((Object(a.openBlock)(),Object(a.createBlock)(r,{accept:".jpg,.jpeg,.png","list-type":"picture","show-file-list":!1,"before-upload":q,"on-success":L,action:Object(a.unref)(o.a).uploadAssets},{default:Object(a.withCtx)((function(){return[Object(a.createElementVNode)("div",b,[s,Object(a.createElementVNode)("img",{class:"logo",src:Object(a.unref)(x).logo||Object(a.unref)(u.a).LOGO},null,8,p)])]})),_:1},8,["action"])),[[S,P.value]])]})),_:1}),Object(a.createVNode)(l,{label:"项目名称",prop:"name"},{default:Object(a.withCtx)((function(){return[Object(a.createVNode)(i,{placeholder:"请输入2-20字项目名称",type:"text",modelValue:Object(a.unref)(x).name,"onUpdate:modelValue":n[0]||(n[0]=function(e){return Object(a.unref)(x).name=e}),maxlength:"20"},null,8,["modelValue"])]})),_:1}),Object(a.createVNode)(l,{label:"项目代号",prop:"code"},{default:Object(a.withCtx)((function(){return[Object(a.createVNode)(i,{placeholder:"部门中的项目序号，如番茄：NRPD-21",type:"text",modelValue:Object(a.unref)(x).code,"onUpdate:modelValue":n[1]||(n[1]=function(e){return Object(a.unref)(x).code=e})},null,8,["modelValue"])]})),_:1}),Object(a.createVNode)(l,{class:"product-form__special",label:"提醒地址",prop:"notify_url"},{default:Object(a.withCtx)((function(){return[Object(a.createElementVNode)("div",null,[Object(a.createVNode)(i,{placeholder:"请输入企业微信群机器人地址，系统会在21:00推送项目进度汇报",type:"text",modelValue:Object(a.unref)(x).notify_url,"onUpdate:modelValue":n[2]||(n[2]=function(e){return Object(a.unref)(x).notify_url=e})},null,8,["modelValue"]),f])]})),_:1}),Object(a.createVNode)(l,{label:"项目备注"},{default:Object(a.withCtx)((function(){return[Object(a.createVNode)(i,{"show-word-limit":"",placeholder:"请输入备注",type:"textarea",autosize:{minRows:4},modelValue:Object(a.unref)(x).remark,"onUpdate:modelValue":n[3]||(n[3]=function(e){return Object(a.unref)(x).remark=e}),maxlength:"500"},null,8,["modelValue"])]})),_:1}),Object(a.createVNode)(l,{label:"需求审批",prop:"is_approval"},{default:Object(a.withCtx)((function(){return[Object(a.createVNode)(d,{"active-value":1,"inactive-value":0,modelValue:Object(a.unref)(x).is_approval,"onUpdate:modelValue":n[4]||(n[4]=function(e){return Object(a.unref)(x).is_approval=e})},null,8,["modelValue"]),1===Object(a.unref)(x).is_approval?(Object(a.openBlock)(),Object(a.createElementBlock)("span",m,"需求池内的需求需要提交审批单，领导审批通过后才可以排期迭代")):(Object(a.openBlock)(),Object(a.createElementBlock)("span",j,"需求池内的需求无需提交审批单，可以直接进行排期迭代"))]})),_:1}),Object(a.createVNode)(l,{label:"邮件汇报",prop:"is_report"},{default:Object(a.withCtx)((function(){return[Object(a.createVNode)(d,{"active-value":1,"inactive-value":0,modelValue:Object(a.unref)(x).is_report,"onUpdate:modelValue":n[5]||(n[5]=function(e){return Object(a.unref)(x).is_report=e})},null,8,["modelValue"]),1===Object(a.unref)(x).is_report?(Object(a.openBlock)(),Object(a.createElementBlock)("span",O,"每周通过邮件向领导汇报项目进度时，需要统计本项目")):(Object(a.openBlock)(),Object(a.createElementBlock)("span",v,"每周通过邮件向领导汇报项目进度时，无需统计本项目"))]})),_:1}),Object(a.createVNode)(l,{label:"周会汇报"},{default:Object(a.withCtx)((function(){return[Object(a.createVNode)(d,{"active-value":1,"inactive-value":0,modelValue:Object(a.unref)(x).week_report,"onUpdate:modelValue":n[6]||(n[6]=function(e){return Object(a.unref)(x).week_report=e})},null,8,["modelValue"]),1===Object(a.unref)(x).week_report?(Object(a.openBlock)(),Object(a.createElementBlock)("div",g,[k,Object(a.createElementVNode)("div",null,[Object(a.createVNode)(l,{label:"选择团队",props:"team",class:"product-form-required"},{default:Object(a.withCtx)((function(){return[Object(a.createVNode)(C,{modelValue:Object(a.unref)(x).team_id,"onUpdate:modelValue":n[7]||(n[7]=function(e){return Object(a.unref)(x).team_id=e}),placeholder:"请选择团队"},{default:Object(a.withCtx)((function(){return[(Object(a.openBlock)(!0),Object(a.createElementBlock)(a.Fragment,null,Object(a.renderList)(Object(a.unref)(B).teamList,(function(e){return Object(a.openBlock)(),Object(a.createBlock)(y,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})])])):(Object(a.openBlock)(),Object(a.createElementBlock)("span",h,"不需要在部门周会中汇报"))]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["title","modelValue"])}}})),y=(n("c2c1"),n("6b0d"));const C=n.n(y)()(x,[["__scopeId","data-v-6cb7046a"]]);t.a=C},a12a:function(e,t,n){},c2c1:function(e,t,n){"use strict";n("a12a")}}]);