(window.webpackJsonp=window.webpackJsonp||[]).push([["exploitation"],{"2e27":function(e,t,a){"use strict";a("358e")},"358e":function(e,t,a){},"39d7":function(e,t,a){},"548b":function(e,t,a){"use strict";a("8152")},6151:function(e,t,a){},"70de":function(e,t,a){"use strict";a.r(t),a("b0c0");var n=a("7a23"),r={key:0,class:"exploitation"},l={class:"search-header"},o={class:"search-right"},i=Object(n.createTextVNode)("导 出"),u=function(e){return Object(n.pushScopeId)("data-v-ca48c9be"),e=e(),Object(n.popScopeId)(),e}((function(){return Object(n.createElementVNode)("span",null,"新增任务",-1)})),c=Object(n.createTextVNode)("批量新增"),d=Object(n.createTextVNode)("关联任务"),s=["onClick"],b=Object(n.createTextVNode)(" - "),m=Object(n.createTextVNode)("删除"),f={class:"rp-test-list-num"},v={class:"rp-test-num"},p={class:"rp-test-num"},O={key:0,class:"rp-use-task-opation"},h=Object(n.createTextVNode)(" 基础项 "),j=Object(n.createTextVNode)("编辑"),_=Object(n.createTextVNode)("复制"),g=Object(n.createTextVNode)("删除"),k={class:"dialog-footer"},C=Object(n.createTextVNode)("取 消"),y=Object(n.createTextVNode)("确 定"),w={key:1,class:"empty-block"},x=a("1da1"),V=a("5530"),N=(a("96cf"),a("d81d"),a("ac1f"),a("1276"),a("5319"),a("d3b7"),a("7db0"),a("a9e3"),a("4de4"),a("159b"),a("caad"),a("d257")),F=a("3a3a"),S=a("c252"),T=a("81ab");function D(){return B.apply(this,arguments)}function B(){return(B=Object(x.a)(regeneratorRuntime.mark((function e(){var t,a,n,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:1,a=r.length>1&&void 0!==r[1]?r[1]:20,n=r.length>2?r[2]:void 0,e.next=5,Object(T.A)(Object(V.a)(Object(V.a)({},n),{},{pageIndex:t,pageSize:a}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=a("913c"),R=a("71ee"),P=a("6669"),L=a("38d1"),I=a("3740"),U=a("5d09"),A=a("9b06"),J=a("7b31"),Y=a("6b59"),q=a("7085"),K=a("9db4"),M=a("eaf6"),H=a("6c02"),z=a("0613"),G=a("5a0c"),$=a.n(G),Q=a("7f6ba"),W=(a("fb6a"),a("2532"),a("a434"),a("23c4")),X=a("2ef0"),Z=a("b23d"),ee=a("f6f2"),te=a("3532"),ae=a("867b"),ne={class:"rp-form-content"},re={style:{display:"flex","align-items":"center","margin-left":"10px"}},le={class:"default-form-item"},oe={class:"default-form-item"},ie={class:"default-form-item",style:{display:"flex","align-items":"center",width:"100px"}},ue=Object(n.createElementVNode)("i",{style:{width:"30px",position:"absolute",left:"110px"}},"小时",-1),ce={class:"default-form-item",style:{display:"flex","align-items":"center",width:"100px"}},de=Object(n.createElementVNode)("i",{style:{width:"30px",position:"absolute",left:"110px"}},"小时",-1),se={class:"file-list"},be=Object(n.createElementVNode)("div",{class:"file-title"},"附件",-1),me={class:"upload-icon"},fe={class:"list-detail"},ve=["onClick"],pe={class:"detail-right"},Oe=Object(n.defineComponent)({props:{iterationList:{type:Array,default:function(){return[]}},demandForm:{type:Object,default:function(){}}},emits:["onChangeTask"],setup:function(e,t){var a,r,l=t.emit,o=e,i=Object(H.f)(),u=Object(n.ref)(i.currentRoute.value.meta.onIteration),c=Object(n.ref)(!1),d=Object(n.ref)(Object(N.G)("productInfo",!0)),s=Object(M.a)().tipMessage,b=Object(N.G)("user",!0),m=JSON.parse(JSON.stringify(W.w)),f=Object(n.ref)([]),v=function(e){Object(ae.a)()(e).then((function(e){e&&e.length?f.value=e:f.value=[]}))},p=Object(n.ref)({}),O=Object(n.computed)((function(){return z.b.getters.productList})),h=Object(n.ref)([]),j=function(){var e,t;null!==(e=d.value)&&void 0!==e&&e.id&&Object(L.e)({product_id:null===(t=d.value)||void 0===t?void 0:t.id}).then((function(e){e.data&&e.data.length?h.value=e.data:h.value=[]}))},_=Object(n.ref)([]),g=function(e,t){e&&Object(T.t)({product_id:e,iteration_id:t||0}).then((function(e){_.value=e.data}))},k=function(){c.value=!0},C=Object(n.computed)((function(){return o.demandForm.attachment})),y=function(e,t,a){if(c.value=!1,e.url){var n=a.slice().map((function(e){return{name:e.name,url:e.response?e.response.url:e.url,size:e.response?e.response.size:e.size,file_type:e.response?e.response.file_type:"",creator:null==b?void 0:b.name,create_time:$()().format("YYYY-MM-DD HH:mm:ss")}}));if(C.value.unshift(n[n.length-1]),o.demandForm.attachment=C.value,!o.demandForm.id)return;var r={ids:[o.demandForm.id],attachment:C.value,field:"attachment"};S(r)}},w=(null===(a=o.demandForm)||void 0===a?void 0:a.hours)||0,V=(null===(r=o.demandForm)||void 0===r?void 0:r.real_hours)||0;Object(n.watch)((function(){return o.demandForm}),(function(e){var t,a;p.value=JSON.parse(JSON.stringify(o.demandForm)),w=null===(t=o.demandForm)||void 0===t?void 0:t.hours,V=null===(a=o.demandForm)||void 0===a?void 0:a.real_hours,setTimeout((function(){e.product_id&&g(e.product_id,e.iteration_id),j(),v(o.demandForm.product_id)}),500)}),{immediate:!0});var F=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(t,a){var n,r,l,i,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("product_id"!==a){e.next=8;break}return o.demandForm.iteration_id=null,o.demandForm.demand_id=null,o.demandForm.demand_name="",e.next=6,v(t);case 6:return e.next=8,g(t,o.demandForm.iteration_id);case 8:if("iteration_id"!==a){e.next=15;break}return o.demandForm.demand_id=null,o.demandForm.demand_name="",t||(t=0),t||(o.demandForm.iteration_id=null),e.next=15,g(o.demandForm.product_id,o.demandForm.iteration_id);case 15:if("demand_id"===a&&(t||(t=0),o.demandForm.demand_id=t),"hours"!==a&&"real_hours"!==a){e.next=42;break}if(""!==t){e.next=21;break}return"hours"===a&&(o.demandForm.hours=w),"real_hours"===a&&(o.demandForm.real_hours=V),e.abrupt("return",s(400,"请输入大于0的正整数"));case 21:if(!Object(X.isNumber)(1*t)){e.next=39;break}if(/^\+?[0-9][0-9]*$/.test(t)){e.next=27;break}return"hours"===a&&(o.demandForm.hours=w),"real_hours"===a&&(o.demandForm.real_hours=V),e.abrupt("return",s(400,"请输入大于0的正整数"));case 27:if(!(Number(t)<=0)){e.next=33;break}if("hours"!==a){e.next=31;break}return o.demandForm.hours=w,e.abrupt("return",s(400,"预计工时请输入大于0的正整数"));case 31:return"real_hours"===a&&(o.demandForm.real_hours=V),e.abrupt("return",s(400,"请输入大于0的正整数"));case 33:if(!(Number(t)>999)){e.next=37;break}return"hours"===a&&(o.demandForm.hours=w),"real_hours"===a&&(o.demandForm.real_hours=V),e.abrupt("return",s(400,"请输入0到999的正整数"));case 37:e.next=40;break;case 39:return e.abrupt("return",s(400,"请输入0到999的正整数"));case 40:w=null===(n=o.demandForm)||void 0===n?void 0:n.hours,V=null===(r=o.demandForm)||void 0===r?void 0:r.real_hours;case 42:if(l={ids:[o.demandForm.id]},"staff_no"===a&&h.value&&(i=h.value[1],u=i.options.filter((function(e){return e.staff_no===t})),l.staff_name=u[0].staff_name,o.demandForm.staff_name=u[0].staff_name,o.demandForm.staff_no=u[0].staff_no),l[a]=t,["status","level","hours","real_hours"].includes(a)&&(l[a]=1*t),"hours"!==a&&"real_hours"!==a||(o.demandForm[a]=l[a]),"begin_time"!==a&&"end_time"!==a){e.next=55;break}if(!o.demandForm.begin_time||!o.demandForm.end_time){e.next=55;break}if(!(o.demandForm.begin_time>o.demandForm.end_time)){e.next=55;break}return s(400,"计划开始时间不能大于结束时间"),o.demandForm.begin_time=null===(c=p.value)||void 0===c?void 0:c.begin_time,o.demandForm.end_time=p.value.end_time,e.abrupt("return");case 55:if(l.field=a,o.demandForm.id){e.next=58;break}return e.abrupt("return");case 58:"status"===a&&(2!==o.demandForm.status||o.demandForm.real_hours||(o.demandForm.real_hours=o.demandForm.hours,l.real_hours=o.demandForm.real_hours)),S(l);case 60:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),S=function(e){Object(T.K)(e).then((function(t){if(200===t.code){if(l("onChangeTask",o.demandForm.id),"staff_no"===e.field&&setTimeout((function(){j()}),500),!e.status||!e.real_hours)return s(200,"成功");s(200,"保存成功，实际工时的值已默认填充预计工时。")}}))};return function(t,a){var r=Object(n.resolveComponent)("el-option"),l=Object(n.resolveComponent)("el-select"),i=Object(n.resolveComponent)("el-form-item"),d=Object(n.resolveComponent)("el-option-group"),s=Object(n.resolveComponent)("el-date-picker"),b=Object(n.resolveComponent)("el-input"),v=Object(n.resolveComponent)("el-form"),p=Object(n.resolveComponent)("el-icon"),j=Object(n.resolveComponent)("el-upload"),g=Object(n.resolveDirective)("loading");return Object(n.openBlock)(),Object(n.createElementBlock)("div",ne,[Object(n.createVNode)(v,{model:e.demandForm,"label-position":"left","label-width":"100px"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(i,{label:"任务类型",prop:"type"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(l,{teleported:!1,class:"reset-select",onChange:a[0]||(a[0]=function(e){return F(e,"type")}),filterable:"",modelValue:e.demandForm.type,"onUpdate:modelValue":a[1]||(a[1]=function(t){return e.demandForm.type=t}),placeholder:"请选择"},{default:Object(n.withCtx)((function(){return[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(Object(n.unref)(W.y),(function(e){return Object(n.openBlock)(),Object(n.createBlock)(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(n.createVNode)(i,{label:"状态"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(l,{teleported:!1,class:"reset-select",onChange:a[2]||(a[2]=function(e){return F(e,"status")}),filterable:"",disabled:!o.demandForm.id,modelValue:e.demandForm.status,"onUpdate:modelValue":a[3]||(a[3]=function(t){return e.demandForm.status=t}),placeholder:"请选择"},{default:Object(n.withCtx)((function(){return[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(Object(n.unref)(m),(function(e){return Object(n.openBlock)(),Object(n.createBlock)(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["disabled","modelValue"])]})),_:1}),Object(n.createVNode)(i,{label:"指派给",prop:"name"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(l,{teleported:!1,class:"reset-select",onChange:a[4]||(a[4]=function(e){return F(e,"staff_no")}),filterable:"",modelValue:e.demandForm.staff_name,"onUpdate:modelValue":a[5]||(a[5]=function(t){return e.demandForm.staff_name=t}),placeholder:"请选择"},{default:Object(n.withCtx)((function(){return[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(h.value,(function(e){return Object(n.openBlock)(),Object(n.createBlock)(d,{key:e.staff_no,label:e.label},{default:Object(n.withCtx)((function(){return[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(e.options,(function(e){return Object(n.openBlock)(),Object(n.createBlock)(r,{key:e.staff_no,label:e.staff_name,value:e.staff_no},null,8,["label","value"])})),128))]})),_:2},1032,["label"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(n.createVNode)(i,{label:"优先级",prop:"level"},{default:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("div",re,[Object(n.createElementVNode)("em",{style:Object(n.normalizeStyle)({width:"8px",height:"8px",marginRight:"4px",display:"inline-block",borderRadius:"5px",background:(t=e.demandForm.level,o=W.f.find((function(e){return e.value==t})),null==o?void 0:o.color)})},null,4),Object(n.createVNode)(l,{style:{display:"flex",flex:1},teleported:!1,onChange:a[6]||(a[6]=function(e){return F(e,"level")}),class:"reset-select",filterable:"",modelValue:e.demandForm.level,"onUpdate:modelValue":a[7]||(a[7]=function(t){return e.demandForm.level=t}),placeholder:"请选择"},{default:Object(n.withCtx)((function(){return[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(Object(n.unref)(W.f),(function(e){return Object(n.openBlock)(),Object(n.createBlock)(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])])];var t,o})),_:1}),Object(n.createVNode)(i,{label:"所属项目",prop:"name"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(l,{teleported:!1,onChange:a[8]||(a[8]=function(e){return F(e,"product_id")}),class:"reset-select",filterable:"",disabled:!u.value&&!e.demandForm.id,modelValue:e.demandForm.product_id,"onUpdate:modelValue":a[9]||(a[9]=function(t){return e.demandForm.product_id=t}),placeholder:"请选择"},{default:Object(n.withCtx)((function(){return[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(Object(n.unref)(O),(function(e){return Object(n.openBlock)(),Object(n.createBlock)(r,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:1},8,["disabled","modelValue"])]})),_:1}),Object(n.createVNode)(i,{label:"所属迭代"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(l,{teleported:!1,onChange:a[10]||(a[10]=function(e){return F(e,"iteration_id")}),class:"reset-select",filterable:"",clearable:"",disabled:!u.value&&!e.demandForm.id,modelValue:e.demandForm.iteration_id,"onUpdate:modelValue":a[11]||(a[11]=function(t){return e.demandForm.iteration_id=t}),placeholder:"请选择"},{default:Object(n.withCtx)((function(){return[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(f.value,(function(e){return Object(n.openBlock)(),Object(n.createBlock)(r,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:1},8,["disabled","modelValue"])]})),_:1}),Object(n.createVNode)(i,{label:"关联需求"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(l,{teleported:!1,onChange:a[12]||(a[12]=function(e){return F(e,"demand_id")}),class:"reset-select",filterable:"",clearable:"",modelValue:e.demandForm.demand_name,"onUpdate:modelValue":a[13]||(a[13]=function(t){return e.demandForm.demand_name=t}),placeholder:"请选择需求"},{default:Object(n.withCtx)((function(){return[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(_.value,(function(e){return Object(n.openBlock)(),Object(n.createBlock)(r,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(n.createVNode)(i,{label:"计划开始时间"},{default:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("div",le,[Object(n.createVNode)(s,{"value-format":"YYYY-MM-DD",onChange:a[14]||(a[14]=function(e){return F(e,"begin_time")}),modelValue:e.demandForm.begin_time,"onUpdate:modelValue":a[15]||(a[15]=function(t){return e.demandForm.begin_time=t}),type:"date",clearable:!1,placeholder:"请选择日期",style:{width:"100%"}},null,8,["modelValue"])])]})),_:1}),Object(n.createVNode)(i,{label:"计划完成时间"},{default:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("div",oe,[Object(n.createVNode)(s,{"value-format":"YYYY-MM-DD",onChange:a[16]||(a[16]=function(e){return F(e,"end_time")}),modelValue:e.demandForm.end_time,"onUpdate:modelValue":a[17]||(a[17]=function(t){return e.demandForm.end_time=t}),type:"date",clearable:!1,placeholder:"请选择日期",style:{width:"100%"}},null,8,["modelValue"])])]})),_:1}),Object(n.createVNode)(i,{label:"预计工时"},{default:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("div",ie,[Object(n.createVNode)(b,{type:"number",onChange:a[18]||(a[18]=function(e){return F(e,"hours")}),modelValue:e.demandForm.hours,"onUpdate:modelValue":a[19]||(a[19]=function(t){return e.demandForm.hours=t})},null,8,["modelValue"]),ue])]})),_:1}),e.demandForm.id?(Object(n.openBlock)(),Object(n.createBlock)(i,{key:0,label:"实际工时"},{default:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("div",ce,[Object(n.createVNode)(b,{type:"number",onChange:a[20]||(a[20]=function(e){return F(e,"real_hours")}),modelValue:e.demandForm.real_hours,"onUpdate:modelValue":a[21]||(a[21]=function(t){return e.demandForm.real_hours=t})},null,8,["modelValue"]),de])]})),_:1})):Object(n.createCommentVNode)("",!0)]})),_:1},8,["model"]),Object(n.createElementVNode)("div",se,[be,Object(n.createElementVNode)("div",null,[Object(n.withDirectives)((Object(n.openBlock)(),Object(n.createBlock)(j,{"show-file-list":!1,"before-upload":k,"on-success":y,action:Object(n.unref)(Z.a).uploadAssets,multiple:!1},{default:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("span",me,[Object(n.createVNode)(p,null,{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(Object(n.unref)(ee.Plus))]})),_:1})])]})),_:1},8,["action"])),[[g,c.value]]),Object(n.createElementVNode)("ul",fe,[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(Object(n.unref)(C),(function(e,t){return Object(n.openBlock)(),Object(n.createElementBlock)("li",{key:e.addr,onClick:function(t){return a=e,void Object(te.a)(a.name||a.title,a.url);var a}},[Object(n.createVNode)(p,{class:"list-detail-icon"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(Object(n.unref)(ee.Document))]})),_:1}),Object(n.createElementVNode)("div",pe,[Object(n.createVNode)(p,{class:"icon-remove",onClick:Object(n.withModifiers)((function(e){return function(e){if(C.value.splice(e,1),o.demandForm.id){var t={ids:[o.demandForm.id],attachment:C.value,field:"attachment"};o.demandForm.id&&S(t)}}(t)}),["stop"])},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(Object(n.unref)(ee.Close))]})),_:2},1032,["onClick"]),Object(n.createElementVNode)("p",null,Object(n.toDisplayString)(e.name),1),Object(n.createElementVNode)("p",null,Object(n.toDisplayString)(e.creator)+" "+Object(n.toDisplayString)(e.create_time),1)])],8,ve)})),128))])])])])}}});a("b426"),a("548b");var he=Oe,je=a("0472"),_e=a("2d40"),ge=Object(n.defineComponent)({name:"exploitation",components:{ArrowUp:Q.a,InputOption:K.a,FormTask:he,FullScreen:R.a,Drawer:je.a,dialogDemand:U.a,selectOption:A.a},setup:function(){var e,t,a,r,l=Object(H.f)(),o=l.currentRoute.value.meta.onIteration,i=Object(n.ref)(!1),u=Object(H.e)(),c=Object(z.c)(),d=Object(n.ref)(),s=Object(n.ref)(),b=Object(n.computed)((function(){var e;return null==c||null===(e=c.getters)||void 0===e?void 0:e.productInfo})),m=Object(M.a)().tipMessage,f=Object(N.G)("user",!0),v=Object(n.ref)("新增任务"),p=Object(n.ref)(!1),O=Object(n.ref)(!1),h=Object(n.reactive)({status:null,ids:[],real_hours:""}),j=Object(n.reactive)({list:[],total:0,bugType:{hour_percent:0,remain_hours:0,total_hours:0}}),_=Object(n.ref)("-1"),g=Object(n.ref)(1),k=Object(n.ref)(!1),C=Object(n.ref)(),y=Object(n.ref)(!1),w=Object(n.computed)((function(){return c.getters.iterateId})),B=Object(E.b)(),R=B.searchParams,U=B.handleGetIterationList,A=B.newDemandLists,K=B.newBasicDemandLists,G=Object(n.ref)(!0),Q=function(){"exploitation"!==l.currentRoute.value.name||w.value?G.value=!0:G.value=!1};Q();var W=Object(n.ref)({staff_no:[],staff_name:[],type:[],iteration_id:null,product_id:null===(e=b.value)||void 0===e?void 0:e.id,demand_id:[],name:"",status:[],expected_start_time:[],time:"",sort_name:"",sort_by:0}),X={staff_no:[],staff_name:[],type:[],iteration_id:null,product_id:null===(t=b.value)||void 0===t?void 0:t.id,demand_id:[],name:"",status:[],expected_start_time:[],time:"",sort_name:"",sort_by:0},Z={attachment:[],begin_time:$()().format("YYYY-MM-DD"),status:0,content:"",end_time:$()().format("YYYY-MM-DD"),hours:0,real_hours:0,iteration_id:null,iteration_name:"",demand_id:null,level:"3",type:2,name:"",product_id:null===(a=b.value)||void 0===a?void 0:a.id,product_name:null===(r=b.value)||void 0===r?void 0:r.name,staff_name:null==f?void 0:f.name,staff_no:null==f?void 0:f.staff_no,remark:""},ee=Object(n.ref)({}),te=Object(n.ref)("view"),ae=Object(n.ref)("view"),ne=Object(n.ref)(!1),re=Object(n.computed)((function(){return c.state.iterateContentVisible})),le=Object(n.ref)([4,5]),oe=Object(n.ref)([]);Object(n.onDeactivated)((function(){ne.value=!1}));var ie=Object(n.ref)([]);Object(n.onMounted)((function(){var e,t,a=u.query,n=a.status,r=a.where,o=a.detailId;"home"===r?(W.value=JSON.parse(JSON.stringify(X)),W.value.product_id=null===(e=b.value)||void 0===e?void 0:e.id,W.value.iteration_id=0,_.value="-10",W.value.status=null==n?void 0:n.split(",").map((function(e){return parseInt(e)})),Ke.searchForm[3].val=W.value.status,ue(null===(t=C.value)||void 0===t?void 0:t.getCurrentPage()),setTimeout((function(){l.replace({path:u.path,query:Object(V.a)(Object(V.a)({},u.query),{},{status:void 0,where:void 0})})}),700)):o&&("exploitation"!==l.currentRoute.value.name&&"projectExploitation"!==l.currentRoute.value.name||de({id:o})),pe(),ye(),xe(),Fe()}));var ue=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(t,a,n,r){var l,i,u,c,d,s,b,m,f,v,p,O,h,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||null!=n&&n.product_id){e.next=3;break}return G.value=!1,e.abrupt("return");case 3:if(y.value=null!=a,g.value=t&&t.pageIndex||1,l={},o?(l=JSON.parse(JSON.stringify(n||Object.assign(W.value,{iteration_id:w.value}))),r?l.iteration_id=null!=Ke&&Ke.searchForm[7].val?Ke.searchForm[7].val:null:null!=Ke&&Ke.searchForm&&null!==(i=Ke.searchForm[7])&&void 0!==i&&i.val?(l.iteration_id=Ke.searchForm[7].val?Ke.searchForm[7].val:w.value,"-1"===_.value&&delete l.iteration_id):delete l.iteration_id):(l=JSON.parse(JSON.stringify(n||Object.assign(W.value,{iteration_id:w.value}))),r&&(l.iteration_id=null!==(u=Ke.searchForm[7].val)&&void 0!==u&&u.length?Ke.searchForm[7].val:w.value)),o||w.value){e.next=14;break}return j.total=0,j.list=[],j.bugType.hour_percent=0,j.bugType.remain_hours=0,j.bugType.total_hours=0,e.abrupt("return");case 14:return c=Object(F.a)(D,l),d=c.response,s=Object(S.a)(d),b=s.pagation,e.next=18,b(t);case 18:m=e.sent,f=m.data,v=f.list,p=f.count,O=f.hour_percent,h=f.remain_hours,k=f.total_hours,j.total=p,j.list=v,j.bugType.hour_percent=O,j.bugType.remain_hours=h,j.bugType.total_hours=k,setTimeout((function(){var e=document.getElementsByClassName("content")[0],t=document.getElementsByClassName("search-header")[0];o?C.value&&(C.value.height=e.offsetHeight-t.offsetHeight-110):C.value&&(C.value.height=e.offsetHeight-t.offsetHeight-130)}),100);case 31:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),ce=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(t,a){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==t){e.next=2;break}return e.abrupt("return");case 2:if(!k.value){e.next=10;break}return C.value.setCurrentPage(),g.value=1,e.next=7,ue({pageIndex:1,pageSize:20},void 0,Object.assign(W.value,{iteration_id:w.value}));case 7:k.value=!1,e.next=12;break;case 10:return e.next=12,ue(null===(n=C.value)||void 0===n?void 0:n.getCurrentPage(),void 0,Object.assign(W.value,{iteration_id:w.value}));case 12:if(y.value=!1,a){e.next=16;break}return e.next=16,U();case 16:pe();case 17:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),de=function(e){v.value="查看详情",te.value="view",ae.value="view",ne.value=!0,i.value=!0,se(e.id),Object(N.u)(e.id)},se=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(t);case 2:return e.next=4,Object(T.i)(t).then((function(e){ee.value=e.data,ee.value.level=ee.value.level+"",ee.value.iteration_id=ee.value.iteration_id?ee.value.iteration_id:null,ee.value.demand_id=ee.value.demand_id?ee.value.demand_id:null})).finally((function(){i.value=!1}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=Object(n.ref)([]),me=function(e){Object(T.j)(e).then((function(e){e.data&&e.data.length?be.value=e.data:be.value=[]}))},fe=Object(n.ref)([]),ve=Object(n.ref)([]),pe=function(){var e,t;null!==(e=b.value)&&void 0!==e&&e.id&&Object(L.e)({product_id:null===(t=b.value)||void 0===t?void 0:t.id}).then((function(e){e.data&&e.data.length?(fe.value=e.data,ve.value=e.data[1].options.map((function(e){return{value:e.staff_no,label:e.staff_name}}))):(fe.value=[],ve.value=[])}))},Oe=function(e){me(e)},he=Object(n.ref)();Object(P.a)(ce,Object(x.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:W.value.product_id!=(null===(t=b.value)||void 0===t?void 0:t.id)&&(W.value.iteration_id=null),W.value.product_id=null===(a=b.value)||void 0===a?void 0:a.id,W.value.iteration_id=w.value,ce(),pe();case 5:case"end":return e.stop()}}),e)}))));var je,ge=function(){var e,t;v.value="新增任务",te.value="add",ae.value="add",Z.product_id=null===(e=b.value)||void 0===e?void 0:e.id,Z.product_name=null===(t=b.value)||void 0===t?void 0:t.name,ee.value=JSON.parse(JSON.stringify(Z)),ee.value.demand_name="",o||(ee.value.iteration_id=w.value),setTimeout((function(){ne.value=!0}),500),be.value=[]},ke=Object(n.ref)([]),Ce=Object(n.ref)([]),ye=function(){var e,t;if(null!==(e=b.value)&&void 0!==e&&e.id){var a={product_id:null===(t=b.value)||void 0===t?void 0:t.id,iteration_id:w.value};clearTimeout(je),je=setTimeout((function(){o&&delete a.iteration_id,Object(q.a)(a).then((function(e){200===e.code?(ke.value=e.data,Ce.value=e.data.map((function(e){return{value:e.id,label:e.name}}))):(ke.value=[],Ce.value=[])}))}),1e3)}},we=Object(n.ref)([]),xe=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(n.computed)((function(){return c.getters.productList})),a=JSON.parse(JSON.stringify(t.value))){e.next=4;break}return e.abrupt("return");case 4:we.value=a.map((function(e){return Object(V.a)(Object(V.a)({},e),{},{value:e.id,label:e.name})}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ve=Object(n.ref)([]),Ne=Object(n.ref)([]),Fe=function(){var e,t;if(null!==(e=b.value)&&void 0!==e&&e.id){var a={product_id:null===(t=b.value)||void 0===t?void 0:t.id,iteration_id:w.value};o&&delete a.iteration_id,Object(T.f)(a).then((function(e){var t;200===e.code?(Ve.value=e.data,Ne.value=null===(t=e.data[1])||void 0===t?void 0:t.options.map((function(e){return{value:e.staff_no,label:e.staff_name}}))):(Ve.value=[],Ne.value=[])}))}};Object(n.watch)((function(){return w.value}),(function(){ce(),ye(),xe(),Fe(),Q()})),Object(n.watch)((function(){return ne.value}),(function(e){var t,a;e||(Object(N.K)(),Ke.searchForm[7].val||o?ue(null===(t=C.value)||void 0===t?void 0:t.getCurrentPage(),void 0,R.value,1):ue(null===(a=C.value)||void 0===a?void 0:a.getCurrentPage(),void 0,R.value),setTimeout((function(){pe()}),500))}));var Se=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=JSON.parse(JSON.stringify(W.value)),o&&delete t.iteration_id,t.time&&t.time.length&&(t.expected_start_time=t.time,delete t.time),delete t.times,delete t.time,a=["status","type","level","staff_no","create_by"],n=0;n<a.length;n++)t[a[n]]&&!t[a[n]].length&&delete t[a[n]],t[a[n]]||delete t[a[n]];if(j.total){e.next=9;break}return e.abrupt("return",m(400,"暂无数据，无法导出"));case 9:Object(N.L)(t,"/api/tomato/task/export");case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te=JSON.parse(JSON.stringify(N.p)),De=function(e){var t=e.id,a=e.real_hours,n=e.hours;h.status=2,h.ids=[t],h.field="status",h.real_hours=a?1*a:1*n,Ee.value=!0},Be=function(){return h.real_hours=1*h.real_hours,/^\+?[0-9][0-9]*$/.test(h.real_hours)?h.real_hours>999||0===h.real_hours?m(400,"请输入0到999的正整数"):void Le(h):m(400,"请输入大于0的正整数")},Ee=Object(n.ref)(!1),Re=function(e){h.status=e},Pe=function(){var e,t=[];return null===(e=ie.value)||void 0===e||e.forEach((function(e){t.push(e.id)})),t},Le=function(e){Object(T.K)(e).then((function(t){var a;if(200===t.code)return ue(null===(a=C.value)||void 0===a?void 0:a.getCurrentPage(),void 0,R.value),Ee.value=!1,"name"===e.field&&Oe(e.ids[0]),"staff_no"===e.field&&setTimeout((function(){pe()}),500),m(200,"成功")}))},Ie=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(N.G)("productInfo",!0),W.value=JSON.parse(JSON.stringify(X)),W.value.product_id=a.id,W.value.iteration_id=R.demand,t.key&&(n={create_by:[null==f?void 0:f.staff_no],staff_no:[null==f?void 0:f.staff_no]},(r={}).product_id=W.value.product_id,r[t.key]=n[t.key],"status"===t.key&&(r[t.key]=t.id.split(",")),W.value[t.key]=r[t.key]),Ae(1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in delete W.value.expected_start_time,delete W.value.expected_end_time,delete W.value.actual_start_time,delete W.value.actual_end_time,_.value="-10",JSON.parse(JSON.stringify(t)).product_id=b.value.id,t)W.value[a]=t[a];Ae(),setTimeout((function(){pe()}),500);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.value=!0,g.value=1,C.value.setCurrentPage(),Ke.searchForm[7].val&&!t?ue(null===(a=C.value)||void 0===a?void 0:a.getCurrentPage(),void 0,R.value,1):ue(null===(n=C.value)||void 0===n?void 0:n.getCurrentPage(),void 0,R.value);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Je=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(t,a){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("add"!==a){e.next=5;break}n=I.a.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),Object(T.e)(t).then((function(){return ne.value=!1,n.close(),m(200,"成功")})),e.next=7;break;case 5:return e.next=7,Le(t);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ye=function(){var e=Object(x.a)(regeneratorRuntime.mark((function e(t,a,n){var r,l,o,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("cancel"!==t){e.next=2;break}return e.abrupt("return",ne.value=!1);case 2:if("title"!==n){e.next=11;break}if(r={ids:[a.id],field:"name",name:a.title},a.title){e.next=6;break}return e.abrupt("return",m(400,"标题不能为空"));case 6:if(!(a.title.length<1||a.title.length>50)){e.next=8;break}return e.abrupt("return",m(400,"请输入1-50个字数内的标题"));case 8:return ee.value.name=a.title,Je(r,"edit"),e.abrupt("return");case 11:if(!a.id){e.next=19;break}return l={ids:[a.id]},"rich"===a.who?(l.content=a.rich,l.field="content",ee.value.content=a.rich):(l.remark=a.rich2,l.field="remark",ee.value.remark=a.rich2),e.next=16,Je(l,"edit");case 16:setTimeout((function(){me(a.id)}),1e3),e.next=41;break;case 19:if(a.title){e.next=21;break}return e.abrupt("return",m(400,"标题不能为空"));case 21:if(!(a.title.length<1||a.title.length>50)){e.next=23;break}return e.abrupt("return",m(400,"请输入1-50个字数内的标题"));case 23:if(ee.value.name=a.title,ee.value.content=a.rich,ee.value.remark=a.rich2,!ee.value.hours&&0!==ee.value.hours){e.next=32;break}if(i=/^\+?[0-9][0-9]*$/,!(Number(ee.value.hours)<=0)){e.next=30;break}return e.abrupt("return",m(400,"预计工时请输入大于0的正整数"));case 30:if(i.test(ee.value.hours)){e.next=32;break}return e.abrupt("return",m(400,"预计工时请输入大于0的正整数"));case 32:if(ee.value.hours=1*ee.value.hours,(u=JSON.parse(JSON.stringify(ee.value))).status=1*ee.value.status,u.level=1*ee.value.level,u.type=1*ee.value.type,u.iteration_id=null!==(o=ee.value.iteration_id)&&void 0!==o?o:0,u.staff_no){e.next=40;break}return e.abrupt("return",m(400,"指派给不能为空"));case 40:Je([u],"add");case 41:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),qe=Object(n.reactive)([{value:"level",label:"优先级",children:N.l.map((function(e){return{value:e.id,label:e.value}}))},{value:"status",label:"状态",children:N.q},{value:"staff_no",label:"指派给",children:[]},{value:"type",label:"类型",children:N.r},{value:"demand_id",label:"需求",children:K},{value:"iteration_id",label:"迭代",children:Ce},{value:"product_id",label:"项目",children:we}]),Ke=Object(n.reactive)({btnArray:[{id:"-1",label:"所有",key:""},{id:"0,1",label:"未完成",key:"status"},{id:"1",label:"进行中",key:"status"},{id:"2",label:"已完成",key:"status"},{id:"5",label:"我创建的",key:"create_by"},{id:"6",label:"指给我的",key:"staff_no"}],searchForm:[{type:"input",label:"任务名称",key:"name",val:""},{type:"select",label:"类型",val:[],multiple:!0,key:"type",listData:N.r},{type:"select",label:"优先级",multiple:!0,key:"level",val:[],valueKey:["id","value"],listData:N.l},{type:"select",label:"状态",multiple:!0,key:"status",val:[],listData:N.p},{type:"select",label:"创建人",val:[],key:"create_by",showRecord:!0,multiple:!0,valueKey:["staff_no","staff_name"],listData:Ve},{type:"select",label:"指派给",val:[],key:"staff_no",showRecord:!0,multiple:!0,valueKey:["staff_no","staff_name"],listData:fe},{type:"select",label:"关联需求",multiple:!1,val:[],key:"demand_id",valueKey:["id","name"],listData:A},{type:"select",label:"关联迭代",multiple:!1,val:[],key:"iteration_id",valueKey:["id","name"],listData:ke},{type:"daterange",label:"预计开始",val:[],typeTime:1,key:"expected_start_time",valueKey:[]}]});return window.addEventListener("storage",(function(e){var t;"setTask"===e.key&&(ue(null===(t=C.value)||void 0===t?void 0:t.getCurrentPage()),Object(N.A)("setTask"))})),Object(n.watch)((function(){return u.query}),(function(){var e,t,a=u.query,n=a.productId,r=a.where,o=a.detailId,i=a.staffNo,c=a.iteration_id,d=a.type,s=a.form;i?(W.value=JSON.parse(JSON.stringify(X)),W.value.product_id=null===(e=b.value)||void 0===e?void 0:e.id,W.value.iteration_id=w.value,W.value.staff_no=[i],Ke.searchForm[5].val=[i],Ke.searchForm[7].val=c?Number(c):[],_.value="-10",ue(null===(t=C.value)||void 0===t?void 0:t.getCurrentPage()),setTimeout((function(){l.replace({path:u.path,query:{productId:n,staffNo:void 0,staffName:void 0}})}),700)):"headerExploitation"===r&&"add"===d?(setTimeout((function(){ge()}),700),l.replace({path:u.path,query:Object(V.a)(Object(V.a)({},u.query),{},{type:void 0})})):"workbench"===r&&"workbench"===s&&(W.value=JSON.parse(JSON.stringify(X)),de({id:o}),setTimeout((function(){l.replace({path:u.path,query:Object(V.a)(Object(V.a)({},u.query),{},{iteration_id:void 0,id:void 0,name:void 0,where:void 0})})}),700))}),{immediate:!0}),Object(V.a)(Object(V.a)({loading:i,sortChange:function(e){var t,a,n=e.prop,r=e.order;r&&(W.value.sort_name=n,W.value.sort_by="ascending"===r?1:2,Ke.searchForm[7].val?ue(null===(t=C.value)||void 0===t?void 0:t.getCurrentPage(),void 0,R.value,1):ue(null===(a=C.value)||void 0===a?void 0:a.getCurrentPage(),void 0,R.value))},staffNo:c.getters.user.staff_no,getTextColor:function(e){var t=N.p.find((function(t){return t.value===e}));return{color:null==t?void 0:t.color}},handleChangeStatus:Re,handleUpdateList:function(e){if(!ie.value||!ie.value.length)return m(400,"请选择要批量操作的列表");Object(N.M)("editTask",JSON.stringify(ie.value));var t=l.resolve({name:"exploitationAdd",query:Object.assign({isEdit:e,type:o?0:1},Object(V.a)({},l.currentRoute.value.query))});window.open(t.href,"_blank")},TYPE_STATUS:N.r,TYPE_STATUS_COPY:[{value:2,label:"已完成",color:"#666666"}],task_select:Te,userList:fe,pageTableRef:C,stopAutoGetData:y,handleConditionSearch:ce},Object(n.toRefs)(j)),{},{getStatus:function(e){var t;return null===(t=N.p.find((function(t){return t.value===e})))||void 0===t?void 0:t.label},getData:ue,handleUpdateStatus:Be,dialogFormData:h,isOpenEditProgress:Ee,handleEditStatus:De,formParams:W,TASK_TYPE:N.p,TASK_TYPE_LIST:N.q,page:g,PRIORITY:N.l,handleTypeList:function(e,t){var a;W.value.status=t,_.value="0,1",ue(null===(a=C.value)||void 0===a?void 0:a.getCurrentPage(),void 0,R.value)},handleSelectionChange:function(e){ie.value=e},selectMore:ie,handleCommand:function(e){if(Re(Number(e)),h.status=Number(e),h.ids=[],!ie.value||!ie.value.length)return m(400,"请选择列表");ie.value.forEach((function(e){h.ids.push(e.id)})),Be()},timeCheck:function(e,t){return t?2===e.delay_state||3===e.delay_state?"#ff0000":"#606266":1===e.delay_state||3===e.delay_state?"#ff0000":"#606266"},exportTaskDate:Se,handleAddDate:function(){var e=l.resolve({name:"exploitationAdd",query:{type:o?0:1}});window.open(e.href,"_blank")},searchArray:Ke,quickSeacrh:Ie,changeSearch:Ue,basicsOption:qe,handleBasicChange:function(e){if("staff_no"===e[0])p.value=!0;else{var t={ids:Pe()},a=s.value.getCheckedNodes()[0].value;if(t[e[0]]=a,["status","level","type","iteration_id","product_id","demand_id"].includes(e[0])&&(t[e[0]]=1*a),t.field=e[0],"staff_no"===e[0]){var n=ve.value.filter((function(e){return e.value===a}));t.staff_name=n[0].label}Le(t)}null==d||d.value.handleClose()},basicBtn:d,basicUserList:ve,onChangeType:function(e,t,a){var n={ids:[t.id]};"hours"===a&&(n.hours=Number(e.label),n.field="hours"),Le(n)},handleDelete:function(e){Y.a.confirm("此操作将永久删除，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",confirmButtonClass:"el-button--danger-box",type:"warning"}).then((function(){!function(e){Object(T.g)(e).then((function(e){var t;200===e.code&&ue(null===(t=C.value)||void 0===t?void 0:t.getCurrentPage(),void 0,R.value)}))}(e?{ids:[e]}:{ids:Pe()})}))},cascaderPanel:s,handleDetail:de,onChangeVal:function(e,t){"complete_percent"===t&&(e.field="complete_percent"),"hours"===t&&(e.field="hours"),Le(e)},richStatus:te,rich2Status:ae,drawer:ne,taskForm:ee,headerTitle:v,onHandle:Ye,iterateData:ke,logData:be,addTaskDate:ge,handleRelativeTask:function(){var e,t={product_id:null===(e=b.value)||void 0===e?void 0:e.id,iteration_id:R.demand,filter_type:1};Object(T.G)(t).then((function(e){200===e.code&&(oe.value=e.data.map((function(e){return{value:e.id,label:e.name}})),setTimeout((function(){c.commit(_e.a.iterateContentVisible,!0)}),200))}))},relativeTaskList:oe,dialogRelative:re,defaultCheck:le,getRelativeDate:function(e){var t={iteration_id:w.value,task_ids:e};e.length?Object(T.H)(t).then((function(e){var t;200===e.code&&(c.commit(_e.a.iterateContentVisible,!1),ue(null===(t=C.value)||void 0===t?void 0:t.getCurrentPage()))})):Object(J.a)({showClose:!0,message:"请选中要关联的任务",type:"warning"})},isFullScreen:O,showAddTaskBtn:o,onChangeTask:Oe,currentActive:_,taskFormParams:he,updateVal:function(e){if("no"!==e){var t=e;t.ids=Pe(),Le(t),p.value=!1}else{var a;ue(null===(a=C.value)||void 0===a?void 0:a.getCurrentPage())}},dialogDemand:p,handleCancle:function(){var e;Ee.value=!1,ue(null===(e=C.value)||void 0===e?void 0:e.getCurrentPage(),void 0,W.value)},onChangeSelect:function(e,t,a){var n={ids:[t.id],field:a};if("staff_no"===a){var r=ve.value.filter((function(t){return t.value===e}));n.staff_no=r[0].value,n.staff_name=r[0].label}if("level"===a&&(n.level=e),"status"===a&&(n.status=e,2===e))return t.status,void De(t);Le(n)},iterateId:w,hasData:G})}}),ke=(a("2e27"),a("9820"),a("6b0d"));const Ce=a.n(ke)()(ge,[["render",function(e,t,a,x,V,N){var F=Object(n.resolveComponent)("search-form"),S=Object(n.resolveComponent)("el-button"),T=Object(n.resolveComponent)("el-dropdown-item"),D=Object(n.resolveComponent)("el-dropdown-menu"),B=Object(n.resolveComponent)("el-dropdown"),E=Object(n.resolveComponent)("el-table-column"),R=Object(n.resolveComponent)("selectOption"),P=Object(n.resolveComponent)("InputOption"),L=Object(n.resolveComponent)("page-table"),I=Object(n.resolveComponent)("ArrowUp"),U=Object(n.resolveComponent)("el-icon"),A=Object(n.resolveComponent)("el-cascader-panel"),J=Object(n.resolveComponent)("el-divider"),Y=Object(n.resolveComponent)("relative-dialog"),q=Object(n.resolveComponent)("el-option"),K=Object(n.resolveComponent)("el-select"),M=Object(n.resolveComponent)("el-form-item"),H=Object(n.resolveComponent)("el-input"),z=Object(n.resolveComponent)("el-form"),G=Object(n.resolveComponent)("el-dialog"),$=Object(n.resolveComponent)("dialog-demand"),Q=Object(n.resolveComponent)("form-task"),W=Object(n.resolveComponent)("Drawer"),X=Object(n.resolveComponent)("FullScreen"),Z=Object(n.resolveComponent)("el-empty"),ee=Object(n.resolveDirective)("debounce");return e.hasData?(Object(n.openBlock)(),Object(n.createElementBlock)("div",r,[Object(n.createVNode)(L,{tableData:e.list,bugType:e.bugType,onHandleSelectionChange:e.handleSelectionChange,onHandlePagationChange:e.getData,total:e.total,isFullScreen:e.isFullScreen,ref:"pageTableRef",highlight:!0,onSortChange:e.sortChange,stopAutoGetData:e.stopAutoGetData,currentPage:e.page},{header:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("div",l,[Object(n.createVNode)(F,{searchArray:e.searchArray,ref:"taskFormParams",currentActive:e.currentActive,onQuickSeacrh:e.quickSeacrh,onChangeSearch:e.changeSearch},null,8,["searchArray","currentActive","onQuickSeacrh","onChangeSearch"]),Object(n.createElementVNode)("div",o,[Object(n.createVNode)(S,{onClick:e.exportTaskDate,style:{"margin-right":"10px"},class:"all-option"},{default:Object(n.withCtx)((function(){return[i]})),_:1},8,["onClick"]),Object(n.createVNode)(B,{"split-button":"",placement:"bottom-end","popper-class":"task-btn",type:"primary",onClick:e.addTaskDate},{dropdown:Object(n.withCtx)((function(){return[Object(n.createVNode)(D,null,{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(T,{onClick:e.handleAddDate},{default:Object(n.withCtx)((function(){return[c]})),_:1},8,["onClick"]),e.showAddTaskBtn?Object(n.createCommentVNode)("",!0):(Object(n.openBlock)(),Object(n.createBlock)(T,{key:0,onClick:e.handleRelativeTask},{default:Object(n.withCtx)((function(){return[d]})),_:1},8,["onClick"]))]})),_:1})]})),default:Object(n.withCtx)((function(){return[u]})),_:1},8,["onClick"])])])]})),main:Object(n.withCtx)((function(){return[Object(n.createVNode)(E,{type:"selection",width:"55"}),Object(n.createVNode)(E,{sortable:"custom",prop:"id",label:"ID",width:"80"}),Object(n.createVNode)(E,{prop:"name",sortable:"custom","class-name":"table-column-left table-title",label:"名称","min-width":"250"},{default:Object(n.withCtx)((function(t){return[Object(n.createElementVNode)("span",{class:"table-link",onClick:function(a){return e.handleDetail(t.row)}},Object(n.toDisplayString)(t.row.name),9,s)]})),_:1}),Object(n.createVNode)(E,{sortable:"custom",prop:"level",label:"优先级","min-width":"80","max-width":"100"},{default:Object(n.withCtx)((function(t){return[Object(n.createVNode)(R,{valueKey:["id","value"],keyVal:"level",currentVal:t.row.level,type:1,currentType:"level",item:t.row,optionsData:e.PRIORITY,onOnChangeSelect:e.onChangeSelect},null,8,["currentVal","item","optionsData","onOnChangeSelect"])]})),_:1}),Object(n.createVNode)(E,{prop:"status",sortable:"custom",label:"状态","min-width":"100","max-width":"120"},{default:Object(n.withCtx)((function(t){return[Object(n.createVNode)(R,{valueKey:["value","label"],keyVal:"status",currentType:"status",currentVal:t.row.status,type:1,item:t.row,optionsData:e.TASK_TYPE_LIST,onOnChangeSelect:e.onChangeSelect},null,8,["currentVal","item","optionsData","onOnChangeSelect"])]})),_:1}),Object(n.createVNode)(E,{prop:"complete_percent",sortable:"custom",label:"进度","min-width":"70","max-width":"110"},{default:Object(n.withCtx)((function(t){return[Object(n.createVNode)(P,{inputVal:t.row.complete_percent,currentId:t.row.id,onOnChangeVal:e.onChangeVal,valKey:"complete_percent",company:"%",module:"exploitation"},null,8,["inputVal","currentId","onOnChangeVal"])]})),_:1}),Object(n.createVNode)(E,{prop:"hours",label:"预计工时",sortable:"custom","min-width":"90","max-width":"130"},{default:Object(n.withCtx)((function(t){return[Object(n.createVNode)(P,{inputVal:t.row.hours,currentId:t.row.id,onOnChangeVal:e.onChangeVal,valKey:"hours"},null,8,["inputVal","currentId","onOnChangeVal"])]})),_:1}),Object(n.createVNode)(E,{prop:"staff_name",sortable:"custom",label:"指派给","min-width":"100","max-width":"130"},{default:Object(n.withCtx)((function(t){return[Object(n.createVNode)(R,{valueKey:["staff_no","staff_name"],keyVal:"staff_no",currentVal:t.row.staff_name,type:0,currentType:"staff_no",item:t.row,optionsData:e.userList,onOnChangeSelect:e.onChangeSelect},null,8,["currentVal","item","optionsData","onOnChangeSelect"])]})),_:1}),Object(n.createVNode)(E,{prop:"begin_time",label:"预计起止",sortable:"custom","min-width":"170","max-width":"240"},{default:Object(n.withCtx)((function(t){return[Object(n.createElementVNode)("span",{style:Object(n.normalizeStyle)({color:e.timeCheck(t.row,0)})},Object(n.toDisplayString)(t.row.begin_time),5),b,Object(n.createElementVNode)("span",{style:Object(n.normalizeStyle)({color:e.timeCheck(t.row,1)})},Object(n.toDisplayString)(t.row.end_time),5)]})),_:1}),Object(n.createVNode)(E,{prop:"real_begin_time",label:"实际起止",sortable:"custom","min-width":"170","max-width":"240"},{default:Object(n.withCtx)((function(e){return[Object(n.createElementVNode)("span",null,Object(n.toDisplayString)(e.row.real_begin_time)+" - "+Object(n.toDisplayString)(e.row.real_end_time),1)]})),_:1}),Object(n.createVNode)(E,{label:"操作","min-width":"70","max-width":"90"},{default:Object(n.withCtx)((function(t){return[Object(n.createVNode)(S,{link:"",class:"delete",onClick:function(a){return e.handleDelete(t.row.id)}},{default:Object(n.withCtx)((function(){return[m]})),_:2},1032,["onClick"])]})),_:1})]})),qucikSelect:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("div",f,[Object(n.createElementVNode)("span",v,"总工时 "+Object(n.toDisplayString)(e.bugType.total_hours)+" h",1),Object(n.createElementVNode)("span",{class:"rp-test-num no-task",onClick:t[0]||(t[0]=function(t){return e.handleTypeList("no",[0,1])})},"未完成 "+Object(n.toDisplayString)(e.bugType.remain_hours)+" h",1),Object(n.createElementVNode)("span",p,"进度 "+Object(n.toDisplayString)(e.bugType.hour_percent)+" %",1)])]})),_:1},8,["tableData","bugType","onHandleSelectionChange","onHandlePagationChange","total","isFullScreen","onSortChange","stopAutoGetData","currentPage"]),e.selectMore.length?(Object(n.openBlock)(),Object(n.createElementBlock)("div",O,[Object(n.createVNode)(B,{size:"small",trigger:"click",ref:"basicBtn"},{dropdown:Object(n.withCtx)((function(){return[Object(n.createVNode)(A,{style:{height:"220px"},onChange:e.handleBasicChange,ref:"cascaderPanel",options:e.basicsOption},null,8,["onChange","options"])]})),default:Object(n.withCtx)((function(){return[Object(n.createVNode)(S,null,{default:Object(n.withCtx)((function(){return[h,Object(n.createVNode)(U,null,{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(I)]})),_:1})]})),_:1})]})),_:1},512),Object(n.createVNode)(J,{direction:"vertical"}),Object(n.createVNode)(S,{onClick:t[1]||(t[1]=function(t){return e.handleUpdateList(1)})},{default:Object(n.withCtx)((function(){return[j]})),_:1}),Object(n.createVNode)(S,{onClick:t[2]||(t[2]=function(t){return e.handleUpdateList(2)})},{default:Object(n.withCtx)((function(){return[_]})),_:1}),Object(n.createVNode)(S,{onClick:t[3]||(t[3]=function(t){return e.handleDelete()})},{default:Object(n.withCtx)((function(){return[g]})),_:1})])):Object(n.createCommentVNode)("",!0),Object(n.createVNode)(Y,{title:"关联任务",defaultCheck:e.defaultCheck,visible:e.dialogRelative,"onUpdate:visible":t[4]||(t[4]=function(t){return e.dialogRelative=t}),onUpdateTree:e.getRelativeDate,sortTreeDate:e.relativeTaskList,placeholder:"搜索标题",inputTitle:""},null,8,["defaultCheck","visible","onUpdateTree","sortTreeDate"]),Object(n.createVNode)(G,{center:"",title:"编辑状态",modelValue:e.isOpenEditProgress,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.isOpenEditProgress=t}),width:"30%"},{footer:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("span",k,[Object(n.createVNode)(S,{onClick:e.handleCancle},{default:Object(n.withCtx)((function(){return[C]})),_:1},8,["onClick"]),Object(n.withDirectives)((Object(n.openBlock)(),Object(n.createBlock)(S,{type:"primary",onClick:e.handleUpdateStatus},{default:Object(n.withCtx)((function(){return[y]})),_:1},8,["onClick"])),[[ee]])])]})),default:Object(n.withCtx)((function(){return[Object(n.createElementVNode)("div",null,[Object(n.createVNode)(z,{"label-width":"80px","label-position":"top",model:e.dialogFormData},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(M,{label:"状态"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(K,{modelValue:e.dialogFormData.status,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.dialogFormData.status=t}),placeholder:"请选择",onChange:e.handleChangeStatus},{default:Object(n.withCtx)((function(){return[(Object(n.openBlock)(!0),Object(n.createElementBlock)(n.Fragment,null,Object(n.renderList)(e.TYPE_STATUS_COPY,(function(e){return Object(n.openBlock)(),Object(n.createBlock)(q,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"])]})),_:1}),2===e.dialogFormData.status?(Object(n.openBlock)(),Object(n.createBlock)(M,{key:0,label:"实际消耗工时"},{default:Object(n.withCtx)((function(){return[Object(n.createVNode)(H,{type:"number",modelValue:e.dialogFormData.real_hours,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.dialogFormData.real_hours=t})},null,8,["modelValue"])]})),_:1})):Object(n.createCommentVNode)("",!0)]})),_:1},8,["model"])])]})),_:1},8,["modelValue"]),Object(n.createVNode)($,{onUpdateVal:e.updateVal,title:"指派给",userList:e.userList,type:2,visible:e.dialogDemand,"onUpdate:visible":t[8]||(t[8]=function(t){return e.dialogDemand=t})},null,8,["onUpdateVal","userList","visible"]),Object(n.createVNode)(W,{drawer:e.drawer,"onUpdate:drawer":t[9]||(t[9]=function(t){return e.drawer=t}),title:e.taskForm.name,headerTitle:e.headerTitle,id:e.taskForm.id,onOnHandle:e.onHandle,rich:e.taskForm.content,rich2:e.taskForm.remark,richStatus:e.richStatus,rich2Status:e.rich2Status,statusList:e.logData,loading:e.loading},{form:Object(n.withCtx)((function(){return[Object(n.createVNode)(Q,{userList:e.userList,onOnChangeTask:e.onChangeTask,iterationList:e.iterateData,demandForm:e.taskForm},null,8,["userList","onOnChangeTask","iterationList","demandForm"])]})),_:1},8,["drawer","title","headerTitle","id","onOnHandle","rich","rich2","richStatus","rich2Status","statusList","loading"]),Object(n.createVNode)(X,{fullscreen:e.isFullScreen,"onUpdate:fullscreen":t[10]||(t[10]=function(t){return e.isFullScreen=t})},null,8,["fullscreen"])])):(Object(n.openBlock)(),Object(n.createElementBlock)("div",w,[Object(n.createVNode)(Z,{"image-size":200})]))}],["__scopeId","data-v-ca48c9be"]]);t.default=Ce},"71ee":function(e,t,a){"use strict";var n=a("7a23"),r=a("d257"),l=Object(n.defineComponent)({props:{fullscreen:{type:Boolean,default:!1}},emits:["update:fullscreen"],setup:function(e,t){var a=t.emit,l=e,o=function(){return Object(n.createVNode)("span",{class:"fullscreen-icon-global iconfont icon-fullscreen",onClick:i},null)},i=function(){a("update:fullscreen",!l.fullscreen),Object(r.P)(),Object(r.I)((function(e){a("update:fullscreen",e)}))};return function(e,t){return Object(n.openBlock)(),Object(n.createBlock)(o)}}}),o=(a("9a6d"),a("6b0d"));const i=a.n(o)()(l,[["__scopeId","data-v-d63bdac2"]]);t.a=i},8152:function(e,t,a){},9820:function(e,t,a){"use strict";a("a534")},"9a6d":function(e,t,a){"use strict";a("39d7")},a534:function(e,t,a){},b426:function(e,t,a){"use strict";a("6151")}}]);