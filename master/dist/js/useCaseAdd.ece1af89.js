(window.webpackJsonp=window.webpackJsonp||[]).push([["useCaseAdd"],{1185:function(e,t,l){"use strict";l.r(t),l("b0c0");var o=l("7a23"),n={class:"container"},a={class:"main"},c=Object(o.createTextVNode)("保 存"),r={class:"default-form-item"},u={key:0},d={key:1},i={key:0},b={key:1},s={key:0},f={key:1},v=l("5530"),p=l("1da1"),m=(l("96cf"),l("159b"),l("99af"),l("d81d"),l("cb29"),l("a434"),l("4de4"),l("caad"),l("7db0"),l("d257")),O=l("81ab"),j=l("3411"),k=l("eaf6"),_=l("6c02"),w=l("36f8"),h=l("66a8"),V=l("3532"),C=l("38d1"),y=l("0613"),B=l("b3ae"),x=Object(o.defineComponent)({name:"useCaseAdd",components:{CirclePlus:w.a,Remove:h.a},setup:function(){var e,t,l,n,a=Object(_.e)(),c=Object(y.c)(),r=Object(o.computed)((function(){return c.getters.iterateId})),u=Object(m.G)("user",!0),d=Object(o.ref)(0),i=Object(o.computed)((function(){var e;return null==c||null===(e=c.getters)||void 0===e?void 0:e.productInfo})),b=Object(o.ref)(),s=Object(o.ref)(!1),f={name:"",type:1,input:"",level:1,premise:"",output:"",product_module_id:0,product_module_name:null===(e=i.value)||void 0===e?void 0:e.name,product_id:null===(t=i.value)||void 0===t?void 0:t.id,iteration_id:r.value,remark:"",staff_name:null==u?void 0:u.name,staff_no:null==u?void 0:u.staff_no,id:++d.value},w=JSON.parse(JSON.stringify(j.a)),h=function(e){L.value.forEach((function(t){var l;t.product_module_id===e&&(t.product_module_id=0,b.value&&b.value[0].name&&(t.product_module_name=(null===(l=b.value[0])||void 0===l?void 0:l.name)||""))}))},x=Object(o.ref)([]),E=Object(o.ref)([]),g=function(){var e=Object(p.a)(regeneratorRuntime.mark((function e(t){var l,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,h(t);case 3:return e.next=5,Object(B.a)({id:null===(l=i.value)||void 0===l?void 0:l.id,name:null===(o=i.value)||void 0===o?void 0:o.name});case 5:null!=(n=e.sent)&&n.length&&(b.value=n,b.value.unshift({value:-1,label:"管理模块",level:-1,id:-1,name:"管理模块"}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(o.onMounted)((function(){g()})),(n=null===(l=i.value)||void 0===l?void 0:l.id)&&Object(C.e)({product_id:n}).then((function(e){var t;e.data&&e.data.length?(x.value=(null===(t=e.data[1])||void 0===t?void 0:t.options)||[],E.value=[{staff_name:"同上",value:-1}].concat(x.value)):(x.value=[],E.value=[])}));var N=w,S=[{value:"同上",id:-1}].concat(w),U=JSON.parse(JSON.stringify(j.c)),T=U,A=[{label:"同上",value:-1}].concat(U),L=Object(o.ref)(Array(a.query.isEdit?1:2).fill({}).map((function(){return Object(v.a)({},f)})));L.value.forEach((function(e,t){t>=1&&(e.type="同上",e.level="同上")}));var R=Object(k.a)().tipMessage;return{moduleTree:b,fileSave:V.a,handleConfirmSave:function(){var e=JSON.parse(JSON.stringify(L.value)).filter((function(e){return""!==e.name}));if(e.length){if("同上"===e[0].type||-1===e[0].type)return R(400,"请选择第1条的用例类型");if(-1===e[0].level||"同上"===e[0].level)return R(400,"请选择第1条的用例等级")}if(e.forEach((function(t,l){var o;if(!t.name)throw R(400,"请输入第".concat(l+1,"条的用例名称")),new Error("未选择类型！");var n=function(o){if(-1!==t[o]&&"同上"!==t[o]||(t[o]=e[l-1][o]),"staff_name"===o&&t[o]&&"所有人"!==t[o]){var n,a=null===(n=x.value.find((function(e){return e.staff_name===t[o]})))||void 0===n?void 0:n.staff_no;e[l].staff_no=a}};for(var a in t)n(a);if(![1,2].includes(t.type))throw R(400,"请输入第".concat(l+1,"条的用例类型")),new Error("未选择类型！");if(!t.level)throw R(400,"请选择第".concat(l+1,"条的用例等级")),new Error("未选择用例等级！");t.product_id=null===(o=i.value)||void 0===o?void 0:o.id,t.iteration_id=r.value})),!e.length)return R(400,"请添加用例");e.forEach((function(e){e.type=1*e.type})),Object(O.b)(e).then((function(e){t(e.code)}));var t=function(e){R(e),200===e&&(localStorage.setItem("setUseCase","caseOption"),window.close())}},CASE_PRIORITY_LAST:S,CASEPRIORITY:N,CASE_STATUS:T,CASE_STATUS_LAST:A,handleRemoveTable:function(e){L.value.length<=1||L.value.splice(e,1)},handlePlusTable:function(e){L.value.splice(e+1,0,Object.assign(Object(v.a)({},f),{level:"同上",type:"同上",id:++d.value}))},tableData:L,isEdit:s,newEmployeeLists:x,employeeLists_last:E,handleModuleClick:function(e,t){t.product_module_id=e.id},idKey:d,getModuleSelectTree:g}}}),E=(l("9aaa"),l("6b0d"));const g=l.n(E)()(x,[["render",function(e,t,l,v,p,m){var O=Object(o.resolveComponent)("el-button"),j=Object(o.resolveComponent)("el-input"),k=Object(o.resolveComponent)("el-table-column"),_=Object(o.resolveComponent)("el-select"),w=Object(o.resolveComponent)("module-select"),h=Object(o.resolveComponent)("el-option"),V=Object(o.resolveComponent)("CirclePlus"),C=Object(o.resolveComponent)("el-icon"),y=Object(o.resolveComponent)("el-divider"),B=Object(o.resolveComponent)("Remove"),x=Object(o.resolveComponent)("el-table"),E=Object(o.resolveDirective)("debounce");return Object(o.openBlock)(),Object(o.createElementBlock)("div",n,[Object(o.createElementVNode)("div",a,[Object(o.withDirectives)((Object(o.openBlock)(),Object(o.createBlock)(O,{type:"primary",style:{float:"right"},onClick:e.handleConfirmSave},{default:Object(o.withCtx)((function(){return[c]})),_:1},8,["onClick"])),[[E]]),Object(o.createVNode)(x,{data:e.tableData},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(k,{prop:"name","class-name":"table-column-left",label:"用例名称",width:"350"},{default:Object(o.withCtx)((function(e){return[Object(o.createVNode)(j,{modelValue:e.row.name,"onUpdate:modelValue":function(t){return e.row.name=t},type:"textarea",maxlength:"100",autosize:{minRows:2,maxRows:4},placeholder:"请输入不超过100字的用例标题"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),Object(o.createVNode)(k,{prop:"product_module_id",label:"模块",width:"130"},{default:Object(o.withCtx)((function(t){var l;return[Object(o.createElementVNode)("div",r,[null!==(l=e.moduleTree)&&void 0!==l&&l.length?(Object(o.openBlock)(),Object(o.createBlock)(w,{key:1,list:e.moduleTree,value:t.row.product_module_id,"onUpdate:value":function(e){return t.row.product_module_id=e},onChange:function(l){return e.handleModuleClick(l,t.row)},onUpdateUseCase:e.getModuleSelectTree},null,8,["list","value","onUpdate:value","onChange","onUpdateUseCase"])):(Object(o.openBlock)(),Object(o.createBlock)(_,{key:0}))])]})),_:1}),Object(o.createVNode)(k,{prop:"type",label:"用例类型",width:"130"},{default:Object(o.withCtx)((function(t){return[Object(o.createVNode)(_,{modelValue:t.row.type,"onUpdate:modelValue":function(e){return t.row.type=e},filterable:"",placeholder:"请选择",disabled:t.row.is_sys},{default:Object(o.withCtx)((function(){return[0==t.$index?(Object(o.openBlock)(),Object(o.createElementBlock)("div",u,[(Object(o.openBlock)(!0),Object(o.createElementBlock)(o.Fragment,null,Object(o.renderList)(e.CASE_STATUS,(function(e){return Object(o.openBlock)(),Object(o.createBlock)(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))])):(Object(o.openBlock)(),Object(o.createElementBlock)("div",d,[(Object(o.openBlock)(!0),Object(o.createElementBlock)(o.Fragment,null,Object(o.renderList)(e.CASE_STATUS_LAST,(function(e){return Object(o.openBlock)(),Object(o.createBlock)(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]))]})),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]})),_:1}),Object(o.createVNode)(k,{prop:"level",label:"用例等级",width:"130"},{default:Object(o.withCtx)((function(t){return[Object(o.createVNode)(_,{modelValue:t.row.level,"onUpdate:modelValue":function(e){return t.row.level=e},filterable:"",placeholder:"请选择",disabled:t.row.is_sys},{default:Object(o.withCtx)((function(){return[0==t.$index?(Object(o.openBlock)(),Object(o.createElementBlock)("div",i,[(Object(o.openBlock)(!0),Object(o.createElementBlock)(o.Fragment,null,Object(o.renderList)(e.CASEPRIORITY,(function(e){return Object(o.openBlock)(),Object(o.createBlock)(h,{key:e.value,label:e.value,value:e.id},null,8,["label","value"])})),128))])):(Object(o.openBlock)(),Object(o.createElementBlock)("div",b,[(Object(o.openBlock)(!0),Object(o.createElementBlock)(o.Fragment,null,Object(o.renderList)(e.CASE_PRIORITY_LAST,(function(e){return Object(o.openBlock)(),Object(o.createBlock)(h,{key:e.value,label:e.value,value:e.id},null,8,["label","value"])})),128))]))]})),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]})),_:1}),Object(o.createVNode)(k,{prop:"address",label:"指派给",width:"120"},{default:Object(o.withCtx)((function(t){return[Object(o.createVNode)(_,{disabled:t.row.is_sys,modelValue:t.row.staff_name,"onUpdate:modelValue":function(e){return t.row.staff_name=e},filterable:"",placeholder:"请选择"},{default:Object(o.withCtx)((function(){return[0==t.$index?(Object(o.openBlock)(),Object(o.createElementBlock)("div",s,[(Object(o.openBlock)(!0),Object(o.createElementBlock)(o.Fragment,null,Object(o.renderList)(e.newEmployeeLists,(function(e){return Object(o.openBlock)(),Object(o.createBlock)(h,{key:e.staff_no,label:e.staff_name,value:e.staff_name},null,8,["label","value"])})),128))])):(Object(o.openBlock)(),Object(o.createElementBlock)("div",f,[(Object(o.openBlock)(!0),Object(o.createElementBlock)(o.Fragment,null,Object(o.renderList)(e.employeeLists_last,(function(e){return Object(o.openBlock)(),Object(o.createBlock)(h,{key:e.staff_no,label:e.staff_name,value:e.staff_name},null,8,["label","value"])})),128))]))]})),_:2},1032,["disabled","modelValue","onUpdate:modelValue"])]})),_:1}),Object(o.createVNode)(k,{prop:"premise",label:"前提"},{default:Object(o.withCtx)((function(e){return[Object(o.createVNode)(j,{placeholder:"请输入0-300字",type:"textarea",rows:3,disabled:e.row.is_sys,modelValue:e.row.premise,"onUpdate:modelValue":function(t){return e.row.premise=t},maxlength:"300"},null,8,["disabled","modelValue","onUpdate:modelValue"])]})),_:1}),Object(o.createVNode)(k,{prop:"input",label:"输入"},{default:Object(o.withCtx)((function(e){return[Object(o.createVNode)(j,{placeholder:"请输入0-300字",type:"textarea",rows:3,disabled:e.row.is_sys,modelValue:e.row.input,"onUpdate:modelValue":function(t){return e.row.input=t},maxlength:"300"},null,8,["disabled","modelValue","onUpdate:modelValue"])]})),_:1}),Object(o.createVNode)(k,{prop:"output",label:"输出"},{default:Object(o.withCtx)((function(e){return[Object(o.createVNode)(j,{placeholder:"请输入0-300字",rows:3,type:"textarea",disabled:e.row.is_sys,modelValue:e.row.output,"onUpdate:modelValue":function(t){return e.row.output=t},maxlength:"300"},null,8,["disabled","modelValue","onUpdate:modelValue"])]})),_:1}),Object(o.createVNode)(k,{prop:"remark","class-name":"table-column-left",label:"备注"},{default:Object(o.withCtx)((function(e){return[Object(o.createVNode)(j,{placeholder:"请输入0-300字",type:"textarea",maxlength:"300",rows:3,modelValue:e.row.remark,"onUpdate:modelValue":function(t){return e.row.remark=t}},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),e.isEdit?Object(o.createCommentVNode)("",!0):(Object(o.openBlock)(),Object(o.createBlock)(k,{key:0,label:"操作",width:"120"},{default:Object(o.withCtx)((function(t){return[Object(o.createVNode)(C,{class:"action",onClick:function(l){return e.handlePlusTable(t.$index)}},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(V)]})),_:2},1032,["onClick"]),Object(o.createVNode)(y,{direction:"vertical"}),Object(o.createVNode)(C,{class:"action",style:Object(o.normalizeStyle)({pointerEvents:0===t.$index?"none":"",color:0===t.$index?"#ccc":""}),disable:0!==t.$index,onClick:function(l){return e.handleRemoveTable(t.$index)}},{default:Object(o.withCtx)((function(){return[Object(o.createVNode)(B)]})),_:2},1032,["style","disable","onClick"])]})),_:1}))]})),_:1},8,["data"])])])}]]);t.default=g},3411:function(e,t,l){"use strict";l.d(t,"a",(function(){return o})),l.d(t,"c",(function(){return n})),l.d(t,"b",(function(){return a}));var o=[{id:1,value:"L0",color:"#dd0101"},{id:2,value:"L1",color:"#f56c6c"},{id:3,value:"L2",color:"#e6a23c"},{id:4,value:"L3",color:"#6a7e02"}],n=[{value:1,label:"冒烟用例"},{value:2,label:"功能用例"}],a=[{value:1,label:"已通过",color:"#1f9f85"},{value:2,label:"未通过",color:"#f56c6c"},{value:3,label:"阻 塞",color:"#f56c6c"},{value:4,label:"锁 定",color:"#e6a23c"},{value:5,label:"未执行",color:"#666"}]},4927:function(e,t,l){},"81d5":function(e,t,l){"use strict";var o=l("7b0b"),n=l("23cb"),a=l("50c4");e.exports=function(e){for(var t=o(this),l=a(t.length),c=arguments.length,r=n(c>1?arguments[1]:void 0,l),u=c>2?arguments[2]:void 0,d=void 0===u?l:n(u,l);d>r;)t[r++]=e;return t}},"9aaa":function(e,t,l){"use strict";l("4927")},cb29:function(e,t,l){var o=l("23e7"),n=l("81d5"),a=l("44d2");o({target:"Array",proto:!0},{fill:n}),a("fill")}}]);