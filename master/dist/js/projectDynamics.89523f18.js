(window.webpackJsonp=window.webpackJsonp||[]).push([["projectDynamics"],{"1b11":function(e,t,n){"use strict";n("809d")},"212d":function(e,t,n){"use strict";n.r(t);var r=n("1da1"),a=n("5530"),o=(n("a9e3"),n("96cf"),n("7a23")),i=n("d257"),c=n("c252"),u=n("3a3a"),d=n("8897");function s(){return l.apply(this,arguments)}function l(){return(l=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:1,n=o.length>1&&void 0!==o[1]?o[1]:20,r=o.length>2?o[2]:void 0,e.next=5,Object(d.f)(Object(a.a)(Object(a.a)({},r),{},{pageIndex:t,pageSize:n}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var p=n("edb3"),m=n("0613"),f=n("eaf6"),b={class:"rp-content-dynmics"},v={class:"rp-work-header"},g={class:"rp-work-content"},_=["onClick","innerHTML"],y=Object(o.defineComponent)(Object(a.a)(Object(a.a)({},{name:"projectDynamics"}),{},{setup:function(e){var t=Object(f.a)().tipMessage,n=Object(m.c)(),a=Object(i.G)("user",!0),l=Object(o.computed)((function(){return n.getters.productList})),y=Object(o.ref)(!1),j=Object(o.ref)({page_index:1,page_size:20,product_id:null,create_time:[],type:null,sort_name:"",sort_by:1,create_by:[]}),h={page_index:1,page_size:20,product_id:null,create_time:[],type:null,sort_name:"",sort_by:1,create_by:[]},O=Object(o.ref)(1);Object(o.onActivated)((function(){P(),R()}));var k,w=Object(o.reactive)({list:[],total:0}),x=Object(o.ref)(),I=Object(o.ref)(!1),C=Object(o.ref)([]),N=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r){var a,o,i,d,l,p,m,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I.value=null!=n,O.value=t&&t.pageIndex||1,a=Object(u.a)(s,r||j.value),o=a.response,i=Object(c.a)(o),d=i.pagation,e.next=6,d(t);case 6:l=e.sent,p=l.data,m=p.list,f=p.count,w.total=f,w.list=m,y.value=!1,f||(y.value=!0);case 14:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),P=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:clearTimeout(k),k=setTimeout(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.value.setCurrentPage(),O.value=1,e.next=4,N({pageIndex:1,pageSize:20},!0,j.value);case 4:I.value=!1;case 5:case"end":return e.stop()}}),e)}))),500);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.g)();case 2:t=e.sent,C.value=t.data;case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=Object(o.reactive)({btnArray:[{id:"-1",label:"所有",key:"all"},{id:"1",label:"项目",key:"type"},{id:"3",label:"需求",key:"type"},{id:"2",label:"迭代",key:"type"},{id:"5",label:"任务",key:"type"},{id:"6",label:"缺陷",key:"type"},{id:null==a?void 0:a.staff_no,label:"我操作的",key:"create_by"}],searchForm:[{type:"select",label:"项目",val:[],key:"product_id",valueKey:["id","name"],listData:l},{type:"select",label:"类别",val:[],key:"type",valueKey:["value","label"],listData:i.e},{type:"select",label:"操作人",val:[],showRecord:!0,key:"create_by",valueKey:["staff_no","staff_name"],listData:C},{type:"daterange",label:"操作时间",val:[],key:"create_time",format:"YYYY-MM-DD",hasShortcuts:!0,valueKey:[]}]});Object(o.onMounted)((function(){Object(o.nextTick)((function(){P(),R()}))}));var T=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.is_jump){e.next=4;break}return e.abrupt("return",t(400,"该数据已删除，无法跳转"));case 4:Object(p.a)(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(e){var t,n;j.value=JSON.parse(JSON.stringify(h)),"create_by"===e.key?j.value.create_by=[e.id]:"type"===e.key&&(j.value.type=Number(e.id)),null===(t=x.value)||void 0===t||t.setCurrentPage(),N(null===(n=x.value)||void 0===n?void 0:n.getCurrentPage())},B=function(e){var t,n;j.value=e,null===(t=x.value)||void 0===t||t.setCurrentPage(),N(null===(n=x.value)||void 0===n?void 0:n.getCurrentPage())};return function(e,t){var n=Object(o.resolveComponent)("search-form"),r=Object(o.resolveComponent)("el-table-column"),a=Object(o.resolveComponent)("page-table"),i=Object(o.resolveComponent)("el-empty");return Object(o.openBlock)(),Object(o.createElementBlock)("div",b,[Object(o.createElementVNode)("div",v,[Object(o.createVNode)(n,{ref:"searchform",searchArray:Object(o.unref)(D),onQuickSeacrh:q,onChangeSearch:B},null,8,["searchArray"])]),Object(o.createElementVNode)("div",g,[y.value?Object(o.createCommentVNode)("",!0):(Object(o.openBlock)(),Object(o.createBlock)(a,{key:0,tableData:Object(o.unref)(w).list,showHeader:!1,onHandlePagationChange:N,total:Object(o.unref)(w).total,ref_key:"pageTableRef",ref:x,currentPage:O.value,stopAutoGetData:I.value},{main:Object(o.withCtx)((function(){return[Object(o.createVNode)(r,{prop:"name","class-name":"table-column-left table-title",label:"名称"},{default:Object(o.withCtx)((function(e){return[Object(o.createElementVNode)("div",{class:"project-title",onClick:Object(o.withModifiers)((function(t){return T(e.row)}),["stop"]),innerHTML:e.row.content},null,8,_)]})),_:1})]})),_:1},8,["tableData","total","currentPage","stopAutoGetData"])),y.value?(Object(o.openBlock)(),Object(o.createBlock)(i,{key:1,description:"您未参与项目或参与的项目暂无动态"})):Object(o.createCommentVNode)("",!0)])])}}}));n("33fe"),n("1b11");const j=y;t.default=j},"248d":function(e,t,n){},"33fe":function(e,t,n){"use strict";n("248d")},"3a3a":function(e,t,n){"use strict";function r(e,t){return{response:function(e,t){return{response:function(n){var r=n=n||{pageIndex:1,pageSize:20},a=r.pageIndex,o=r.pageSize;return e&&e(a,o,t)}}}(e,t).response}}n.d(t,"a",(function(){return r}))},"809d":function(e,t,n){},"867b":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("1da1"),a=(n("96cf"),n("81ab"));function o(){return function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.p)({product_id:t,status:-1});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},8897:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"h",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"l",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"n",(function(){return g})),n.d(t,"i",(function(){return _})),n("99af");var r=n("79f6"),a=n("b23d");function o(){return r.a.get(a.a.getDashboard)}function i(){return r.a.get(a.a.getListParticipate)}function c(){return r.a.get(a.a.getTimeline)}function u(e){return e.start_time=e.start_time?e.start_time+" 00:00:00":"",e.end_time=e.end_time?e.end_time+" 23:59:59":"",delete e.times,delete e.sort_name,r.a.get(a.a.getWorkTeam,e)}function d(e){return e.start_time=e.start_time?e.start_time+" 00:00:00":"",e.end_time=e.end_time?e.end_time+" 23:59:59":"",e.page_size=30,delete e.times,delete e.sort_name,r.a.get(a.a.getWorkTeamToDo,e)}function s(e){return e.type||delete e.type,e.create_by||delete e.create_by,e.create_by_no&&e.create_by_no.length?e.create_by=e.create_by_no:delete e.create_by_no,r.a.get(a.a.getProductDynamic,e)}function l(){return r.a.get(a.a.getProductPeople)}function p(e){return r.a.post(a.a.handleTomatoBackLog,e)}function m(e){return e.start_time=e.start_time?e.start_time+" 00:00:00":"",e.end_time=e.end_time?e.end_time+" 23:59:59":"",r.a.get(a.a.getCalenderList,e)}function f(e){var t=e.id,n=e.month;return r.a.get(a.a.handleTomatoBackLog+"/".concat(t,"?month=").concat(n||""))}function b(e){return r.a.put(a.a.handleTomatoBackLog+"/status",e)}function v(e){return r.a.post(a.a.delCalenderBackLog,e)}function g(e){return r.a.put(a.a.updateBugStatus,e)}function _(e){return r.a.get(a.a.handleTomatoBackLog,e)}},c252:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("1da1");function a(e){return{pagation:function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}n("96cf")},edb3:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}));var r=n("1da1"),a=(n("96cf"),n("7db0"),n("4de4"),n("caad"),n("2532"),n("d3b7"),n("b0c0"),n("913c")),o=n("867b"),i=n("afbc"),c=n("0613"),u=n("2d40");function d(e,t){return s.apply(this,arguments)}function s(){return(s=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r,d,s,l,p,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.product_id){e.next=7;break}return c.b.commit(u.a.updateProductId,t.product_id),(r=c.b.getters.productList.find((function(e){return e.id===t.product_id})))&&c.b.commit(u.a.updateProductInfo,r),d=Object(o.a)(),e.next=7,d(t.product_id).then((function(e){var n;return a.c.value=e,t.iteration_id?a.f.demand=t.iteration_id:a.f.demand=(null===(n=a.c.value[0])||void 0===n?void 0:n.id)||0,c.b.commit(u.a.updateIterateId,a.f.demand),c.b.commit(u.a.updateIterateList,e),c.b.commit(u.a.updateCurrentIter),Promise.resolve()}));case 7:3!==t.type&&(a.f.demand=t.iteration_id,c.b.commit(u.a.updateIterateId,a.f.demand)),(t.target_id||n)&&Object(a.g)(t.iteration_id),s=["homepage","projectExploitation","test"],l={projectExploitation:{baseName:"projectExploitation",query:{iteration_id:t.iteration_id,id:t.target_id,name:t.name,where:"workbench"}},homepage:{baseName:"homepage",query:{iterateId:t.iteration_id}},test:{baseName:"test",query:{detailId:t.target_id,name:t.obj_name,where:"workbench"}}},n?(p=i.a.resolve({path:"/project/iteration/homepage",query:{productId:t.product_id,iterateId:t.iteration_id,come:"lookBoard"}}),m=p.href,window.open(m,"_blank")):i.a.push({name:l[s[t.type-1]].baseName,query:l[s[t.type-1]].query});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){if(e.product_id){c.b.commit(u.a.updateProductId,e.product_id);var t=c.b.getters.productList.find((function(t){return t.id===e.product_id}));t&&c.b.commit(u.a.updateProductInfo,t),Object(o.a)()(e.product_id).then((function(t){if(a.c.value=t,0===e.iteration_id){var n;a.f.demand=(null===(n=a.c.value[0])||void 0===n?void 0:n.id)||null,c.b.commit(u.a.updateIterateId,e.iteration_id)}else{var r=a.c.value&&a.c.value.filter((function(t){return t.id===e.iteration_id}));a.f.demand=e.iteration_id,c.b.commit(u.a.updateIterateId,e.iteration_id),c.b.commit(u.a.updateCurrentIter,r[0]||null)}}))}[3,4,6].includes(e.type)||(a.f.demand=e.iteration_id,c.b.commit(u.a.updateIterateId,e.iteration_id)),e.target_id&&Object(a.g)(e.iteration_id);var n={homepage:{baseName:"homepage",query:{}},demandPool:{baseName:e.event.includes("demand-approval")?"approval":"demandPool",query:{name:e.event.includes("demand-approval")?"":e.obj_name,productId:e.product_id,auto:1,ids:e.obj_id,fromNotices:!0}},planManagement:{baseName:"planManagement",query:{name:e.obj_name,productId:e.product_id,where:"workbench"}},projectExploitation:{baseName:"projectExploitation",query:{iteration_id:e.iteration_id,detailId:e.obj_id,where:"workbench",form:"workbench"}},test:{baseName:"test",query:{detailId:e.obj_id,where:"workbench"}}},r=e.type>=3?["homepage","homepage","demandPool","planManagement","projectExploitation","test"][e.type-1]:"homepage";i.a.push({name:n[r].baseName,query:n[r].query})}}}]);