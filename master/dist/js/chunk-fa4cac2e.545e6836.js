(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-fa4cac2e"],{"16df":function(e,t,n){"use strict";var a=n("1da1"),r=n("5530"),c=(n("b0c0"),n("96cf"),n("7a23")),o=n("59a4"),l=(n("a9e3"),n("fb6a"),n("7db0"),n("99af"),n("5a0c")),i=n.n(l),u=n("d257"),s=n("efa4"),d=n("b781"),f={class:"calendar-slot-tasks"},b={class:"calendar-slot-tasks"},m=["onClick"],p=Object(c.defineComponent)(Object(r.a)(Object(r.a)({},{name:"calendar-slot-tasks"}),{},{props:{tasksVisible:{type:Boolean,default:!1},data:{type:Object,default:function(){return{}}},list:{type:Array,default:function(){return[]}}},emits:["update:tasksVisible","handleItem","lookDetail"],setup:function(e,t){var n=t.emit,r=e,l=Object(o.a)(),s=l.useHandleProductCache,d=l.productList,p=Object(c.computed)((function(){return r.tasksVisible})),v=Object(c.computed)((function(){var e=r.data.day;return"".concat(i()(e).format("YYYY[年]M[月]D[日]工作项"))})),j=function(){n("update:tasksVisible",!1)},O=function(e,t){var n=u.t.find((function(t){return t.value===e}));return t?{background:null==n?void 0:n.color}:null==n?void 0:n.label},k=function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.length||4===t.type){e.next=6;break}return e.next=3,s(t.product_id);case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:4===t.type?n("handleItem",t):n("lookDetail",t),j();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return function(t,n){var a=Object(c.resolveComponent)("el-dialog");return Object(c.openBlock)(),Object(c.createElementBlock)("div",f,[Object(c.createVNode)(a,{modelValue:Object(c.unref)(p),"onUpdate:modelValue":n[0]||(n[0]=function(e){return Object(c.isRef)(p)?p.value=e:null}),"append-to-body":"",title:Object(c.unref)(v),width:"30%","before-close":j},{default:Object(c.withCtx)((function(){return[Object(c.createElementVNode)("div",b,[(Object(c.openBlock)(!0),Object(c.createElementBlock)(c.Fragment,null,Object(c.renderList)(e.list,(function(e){return Object(c.openBlock)(),Object(c.createElementBlock)("p",{onClick:function(t){return k(e)},class:"calendar-slot-tasks__item",key:e.id},[Object(c.createElementVNode)("span",{class:"calendar-slot-tasks__item-span type-status-tag",style:Object(c.normalizeStyle)(O(e.type,1))},Object(c.toDisplayString)(O(e.type,0)),5),Object(c.createElementVNode)("span",{class:Object(c.normalizeClass)(3===e.status?"calendar-slot-tasks__item-pass":"")},Object(c.toDisplayString)(1===e.type?"".concat(e.name,"-").concat(null==e?void 0:e.iteration_node):e.name),3)],8,m)})),128))])]})),_:1},8,["modelValue","title"])])}}})),v=(n("49a2"),n("b520"),n("6b0d")),j=n.n(v),O=j()(p,[["__scopeId","data-v-00246142"]]),k=n("fbaf"),y={class:"work-calendar"},w={class:"work-calendar__day"},g={class:"work-calendar__list"},h=["onClick"],D={key:1,class:"work-calendar__list-span"},_={name:"CalendarSlot",components:{CalendarSlotTips:d.a,CalendarSlotTasks:O,HandleWaitDialog:s.a,HandlePerson:k.a}},Y=Object(c.defineComponent)(Object(r.a)(Object(r.a)({},_),{},{props:{data:{type:Object,default:function(){return{}}},calendarList:{type:Array,default:function(){return[]}},calHeight:{type:Number,default:0}},emits:["updateData","lookDetail"],setup:function(e,t){var n=t.emit,r=e,l=Object(c.ref)(!1),f=Object(c.ref)(!1),b=Object(c.ref)(!1),m=Object(c.ref)(!1),p=Object(c.ref)(!1),v=Object(c.ref)(),j=Object(c.reactive)({department:[],team_worker:[],selectPerson:[],day:r.data,type:0,fromType:"",abeyancenEditItem:{}}),_=Object(c.ref)(),Y=Object(c.ref)(0),V=Object(c.ref)(2),C=Object(o.a)(),x=C.useGetIterationDetail,B=C.useGetBackLogDetail,E=C.useGetBugDetail,M=C.useGetTaskDetail;Object(c.watch)((function(){return l.value}),(function(e){b.value=e})),Object(c.watch)((function(){return r.calHeight}),(function(e){R()})),Object(c.watch)((function(){return r.calendarList}),(function(e){e&&Object(c.nextTick)((function(){return U()})),e&&(j.day=r.data)}),{deep:!0,immediate:!0});var R=function(){Y.value=(r.calHeight-70)/5,Y.value=Y.value<80?80:Y.value,V.value=Math.floor((Y.value-50)/18)},N=Object(c.computed)((function(){var e=r.data.day;return i()(e).format("D")})),I=Object(c.computed)((function(){var e,t,n;return(null===(e=_.value)||void 0===e?void 0:e.length)<=V.value+1?[]:null===(t=_.value)||void 0===t?void 0:t.slice(V.value,null===(n=_.value)||void 0===n?void 0:n.length)})),S=function(e){p.value=e},L=function(e){var t=e.department,n=e.team_worker,a=e.selectPerson;j.department=t,j.team_worker=n,j.selectPerson=a},T=function(e){n("lookDetail",e)},P=function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==t){e.next=4;break}m.value=!0,e.next=7;break;case 4:if(a){e.next=6;break}return e.abrupt("return");case 6:n("lookDetail",a);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),H=function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(t,n){var a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[x,M,E],3!==t){e.next=5;break}return e.next=4,B({id:n,month:null===(c=r.data)||void 0===c?void 0:c.day});case 4:return e.abrupt("return",e.sent);case 5:return e.next=7,a[t](n);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),U=function(){var e,t=r.data.day;if(!Array.isArray(r.calendarList))return[];_.value=null===(e=r.calendarList.find((function(e){return new Date(e.date).getTime()===new Date(t).getTime()})))||void 0===e?void 0:e.list},z=function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(t.type-1,t.target_id);case 2:n=e.sent,l.value=!0,n&&(j.abeyancenEditItem=n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){n("updateData"),f.value=!1,m.value=!1,j.abeyancenEditItem={}};return function(t,n){var a,r,o,i;return Object(c.openBlock)(),Object(c.createElementBlock)("div",{class:"work-calendar",style:Object(c.normalizeStyle)("height: ".concat(Y.value||"","px"))},[Object(c.createElementVNode)("div",y,[Object(c.createElementVNode)("div",w,Object(c.toDisplayString)(Object(c.unref)(N)),1),Object(c.createElementVNode)("div",g,[(Object(c.openBlock)(!0),Object(c.createElementBlock)(c.Fragment,null,Object(c.renderList)(null===(a=_.value)||void 0===a?void 0:a.slice(0,_.value.length<=V.value+1?_.value.length:V.value),(function(e,t){return Object(c.openBlock)(),Object(c.createElementBlock)("div",{class:Object(c.normalizeClass)(["work-calendar__list-span",{"work-calendar__list-pass":3===e.status}]),key:t,onClick:Object(c.withModifiers)((function(t){return P(2,e)}),["stop"])},[Object(c.createElementVNode)("span",{class:"type-status-dot",style:Object(c.normalizeStyle)((n=e.type,1,a=u.t.find((function(e){return e.value===n})),{background:null==a?void 0:a.color}))},null,4),Object(c.createTextVNode)(" "+Object(c.toDisplayString)(1===e.type?"".concat(null==e?void 0:e.iteration_node,"-").concat(e.name):e.name),1)],10,h);var n,a})),128))]),null!==(r=Object(c.unref)(I))&&void 0!==r&&r.length?(Object(c.openBlock)(),Object(c.createElementBlock)("div",{key:0,class:"work-calendar__list-cal",onClick:n[0]||(n[0]=Object(c.withModifiers)((function(e){return P(1)}),["stop"]))},"还有"+Object(c.toDisplayString)(null===(o=Object(c.unref)(I))||void 0===o?void 0:o.length)+"个工作项",1)):Object(c.createCommentVNode)("",!0),null!==(i=Object(c.unref)(I))&&void 0!==i&&i.length||!b.value||!e.data.isSelected?Object(c.createCommentVNode)("",!0):(Object(c.openBlock)(),Object(c.createElementBlock)("div",D,Object(c.toDisplayString)("新建待办")))]),Object(c.createVNode)(s.a,{personInfo:Object(c.unref)(j),item:Object(c.unref)(j).abeyancenEditItem,onShow:S,onUpdateData:A,visible:l.value,"onUpdate:visible":n[1]||(n[1]=function(e){return l.value=e})},null,8,["personInfo","item","visible"]),Object(c.createVNode)(d.a,{personInfo:Object(c.unref)(j),onHandleItem:z,item:v.value,onUpdateData:A,type:Object(c.unref)(j).type,tipsVisible:f.value,"onUpdate:tipsVisible":n[2]||(n[2]=function(e){return f.value=e})},null,8,["personInfo","item","type","tipsVisible"]),Object(c.createVNode)(O,{onLookDetail:T,onHandleItem:n[3]||(n[3]=function(e){return P(2,e)}),data:e.data,list:_.value,tasksVisible:m.value,"onUpdate:tasksVisible":n[4]||(n[4]=function(e){return m.value=e})},null,8,["data","list","tasksVisible"]),Object(c.createVNode)(k.a,{onSubmit:L,visible:p.value,"onUpdate:visible":n[5]||(n[5]=function(e){return p.value=e}),item:Object(c.unref)(j).abeyancenEditItem},null,8,["visible","item"])],4)}}}));n("51ab");var V=j()(Y,[["__scopeId","data-v-6dc4afdb"]]),C=n("0613"),x=n("2d40"),B=n("2ef0"),E={name:"work",components:{CalendarSlot:V}},M=Object(c.defineComponent)(Object(r.a)(Object(r.a)({},E),{},{props:{formParams:{type:Object,default:function(){return{}}}},emits:["lookDetail"],setup:function(e,t){var n=t.expose,r=t.emit,l=e,u=Object(o.a)(),s=u.calendar,d=u.calendarList,f=u.useGetCarlenderInfo,b=Object(c.ref)(),m=Object(c.ref)(""),p=Object(C.c)(),v=Object(c.ref)(""),j=Object(c.ref)(!1);Object(c.watch)((function(){return l.formParams}),(function(e){e&&Object(c.nextTick)((function(){return y()}))}),{deep:!0,immediate:!0});var O=Object(c.computed)((function(){return d.value}));Object(c.watch)((function(){return m.value}),(function(e,t){var n=new Date(i()(e).format("YYYY-MM")).getTime(),r=new Date(i()(t).format("YYYY-MM")).getTime();new Date(i()(v.value).format("YYYY-MM")).getTime()!==n&&n!==r&&Object(c.nextTick)(Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:p.commit(x.a.updateCalendarDay,s.value.selectedDay.format("YYYY-MM")),v.value=s.value.selectedDay.format("YYYY-MM");case 4:case"end":return e.stop()}}),e)}))))}));var k=function(e){r("lookDetail",e)},y=function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(){var t,n,r,o,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.value){e.next=2;break}return e.abrupt("return");case 2:j.value=!0,t=l.formParams,n=t.name,r=t.status,o=t.type,i=t.end_time,u=t.start_time,Object(c.nextTick)(Object(a.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=s.value.selectedDay)){e.next=4;break}return e.next=4,f({month:t.format("YYYY-MM"),name:n,status:r,type:o,end_time:i,start_time:u});case 4:j.value=!1;case 5:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n({changeMonth:function(e){s.value.selectDate(e),p.commit(x.a.updateCalendarDay,s.value.selectedDay.format("YYYY-MM"))},curDate:function(){return s.value.selectedDay.format("YYYY-MM")}}),Object(c.onMounted)((function(){var e,t;6===(t=document.getElementById("work-calendar").querySelectorAll(".el-calendar-table__row")).length&&t[5].remove(),y(),m.value=i()().format("YYYY-MM"),b.value=null===(e=s.value)||void 0===e?void 0:e.$el.getBoundingClientRect().height,p.commit(x.a.updateCalendarDay,m.value),v.value=m.value,window.addEventListener("resize",Object(B.throttle)((function(){var e;b.value=null===(e=s.value)||void 0===e?void 0:e.$el.getBoundingClientRect().height}),500),!1)})),function(e,t){var n=Object(c.resolveComponent)("el-calendar"),a=Object(c.resolveDirective)("loading");return Object(c.withDirectives)((Object(c.openBlock)(),Object(c.createBlock)(n,{ref_key:"calendar",ref:s,class:"work-calendar work-calendar-liner",id:"work-calendar",modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=function(e){return m.value=e})},{dateCell:Object(c.withCtx)((function(e){var t=e.data;return[Object(c.createVNode)(V,{calendarList:Object(c.unref)(O),calHeight:b.value,onLookDetail:k,onUpdateData:y,data:t},null,8,["calendarList","calHeight","data"])]})),_:1},8,["modelValue"])),[[a,j.value]])}}}));n("3fc6");const R=M;t.a=R},"3b99":function(e,t,n){},"3fc6":function(e,t,n){"use strict";n("a142")},"49a2":function(e,t,n){"use strict";n("7967")},"51ab":function(e,t,n){"use strict";n("f4e2")},"593a":function(e,t,n){},7967:function(e,t,n){},"7b82":function(e,t,n){"use strict";n("593a")},a142:function(e,t,n){},b520:function(e,t,n){"use strict";n("3b99")},e934:function(e,t,n){"use strict";var a=n("5530"),r=n("7a23"),c=n("0613"),o={class:"calendar-title"},l={class:"calendar-title__text"},i=Object(r.defineComponent)(Object(a.a)(Object(a.a)({},{name:"calendar-title"}),{},{props:{workRefs:{type:Object,default:function(){return{}}}},setup:function(e){var t=e,n=Object(c.c)().getters,a=Object(r.computed)((function(){return n.workCalendarDay})),i=function(e){var n;if("down"===e)null===(n=t.workRefs)||void 0===n||n.changeMonth("next-month");else if("up"===e){var a;null===(a=t.workRefs)||void 0===a||a.changeMonth("prev-month")}};return function(e,t){return Object(r.openBlock)(),Object(r.createElementBlock)("div",o,[Object(r.createElementVNode)("i",{onClick:t[0]||(t[0]=function(e){return i("up")}),class:"calendar-title__icon iconfont icon-arrowup"}),Object(r.createElementVNode)("span",l,Object(r.toDisplayString)(Object(r.unref)(a)),1),Object(r.createElementVNode)("i",{onClick:t[1]||(t[1]=function(e){return i("down")}),class:"calendar-title__icon iconfont icon-arrowdown"})])}}}));n("7b82");const u=i;t.a=u},f4e2:function(e,t,n){},f905:function(e,t,n){"use strict";n.r(t);var a=n("5530"),r=n("7a23"),c=n("e934"),o=n("16df"),l={style:{height:"100%"}},i={name:"calendarList",components:{WorkCalendar:o.a}};const u=Object(r.defineComponent)(Object(a.a)(Object(a.a)({},i),{},{props:{formParams:{type:Object,default:function(){return{}}}},emits:["lookDetail"],setup:function(e,t){var n=t.emit,a=Object(r.ref)(),i=function(e){n("lookDetail",e)};return function(t,n){return Object(r.openBlock)(),Object(r.createElementBlock)("div",l,[Object(r.createVNode)(c.a,{workRefs:a.value},null,8,["workRefs"]),Object(r.createVNode)(o.a,{onLookDetail:i,formParams:e.formParams,ref_key:"workRefs",ref:a},null,8,["formParams"])])}}}));t.default=u}}]);